{
    "reason": "",
    "state": "MERGED",
    "updated_on": "2016-06-29T18:06:47.669079+00:00",
    "comment_count": 9,
    "description": "This fixes the issue reported on the mailing list where yt errors out when one tries to set the magnetic unit to 1 T (or any MKS unit).\r\n\r\nThis ended up being a little subtle and required some changes to the equivalency and unit system machinery. I'd appreciate it if @jzuhone would take a look. It might be easier to understand if you look at each commit individually - I tried to keep things atomic.\r\n\r\n* Move implementations for some unit equivalency functions to the Unit class\r\n\r\n    I'm leaving the original functions behind with implementations that delegate to\r\n    the new functions on the Unit object to maintain API compatibility and for\r\n    conveinience.\r\n\r\n* Add a cgs-ampere unit system.\r\n\r\n    This system is only used internally, and is necessary because it's the only\r\n    unit system where quantities with both CGS and SI EM units are representable.\r\n\r\n* Make it possible to create a code unit system with MKS base units\r\n\r\n* Don't add nonexistent dimensions to the unit system's internal state\r\n\r\n* Regenerate unit system units if the underlying dimensions change\r\n\r\n* flush unit registry unit_objs cache if a unit symbol is removed or modified\r\n\r\n* When updating a unit registry, convert to yt's internal cgs-ampere unit system\r\n\r\n* Make it possible to update the dimensions of a unit registry entry\r\n\r\n* Fix bug in _get_unit_system_string where units in the base units weren't always getting returned\r\n\r\n* Only modify unit registries inside the base dataset class to avoid order of operations issues\r\n\r\n* Rearrange the order in which a dataset's unit systems get set up\r\n\r\n* Accept lower of upper-case versions of unit system names\r\n\r\n* Handle the case when ds.magnetic_unit is provided in MKS for all unit systems\r\n\r\n* Add tests for magnetic units",
    "created_on": "2016-06-03T21:03:49.235014+00:00",
    "task_count": 0,
    "merge_commit": {
        "links": {
            "self": {
                "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/commit/9b2d8e598c95"
            }
        },
        "hash": "9b2d8e598c95"
    },
    "title": "MKS code unit system fixes. Closes #1229",
    "links": {
        "diff": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2213/diff"
        },
        "decline": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2213/decline"
        },
        "self": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2213"
        },
        "activity": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2213/activity"
        },
        "merge": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2213/merge"
        },
        "commits": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2213/commits"
        },
        "statuses": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2213/statuses"
        },
        "approve": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2213/approve"
        },
        "html": {
            "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2213"
        },
        "comments": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2213/comments"
        }
    },
    "closed_by": {
        "links": {
            "self": {
                "href": "https://api.bitbucket.org/2.0/users/xarthisius"
            },
            "html": {
                "href": "https://bitbucket.org/xarthisius/"
            },
            "avatar": {
                "href": "https://bitbucket.org/account/xarthisius/avatar/32/"
            }
        },
        "type": "user",
        "display_name": "Kacper Kowalik",
        "uuid": "{26af8f1d-35b3-46ce-9939-09915b06e31f}",
        "username": "xarthisius"
    },
    "id": 2213,
    "type": "pullrequest",
    "author": {
        "links": {
            "self": {
                "href": "https://api.bitbucket.org/2.0/users/ngoldbaum"
            },
            "html": {
                "href": "https://bitbucket.org/ngoldbaum/"
            },
            "avatar": {
                "href": "https://bitbucket.org/account/ngoldbaum/avatar/32/"
            }
        },
        "type": "user",
        "display_name": "Nathan Goldbaum",
        "uuid": "{5dcd72da-6420-4a6d-9571-e75dffcac587}",
        "username": "ngoldbaum"
    },
    "source": {
        "branch": {
            "name": "yt"
        },
        "commit": {
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/ngoldbaum/yt/commit/82ad6ff08522"
                }
            },
            "hash": "82ad6ff08522"
        },
        "repository": {
            "full_name": "ngoldbaum/yt",
            "type": "repository",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/ngoldbaum/yt"
                },
                "html": {
                    "href": "https://bitbucket.org/ngoldbaum/yt"
                },
                "avatar": {
                    "href": "https://bitbucket.org/ngoldbaum/yt/avatar/32/"
                }
            },
            "name": "yt",
            "uuid": "{cb18d7d9-ab77-4e80-81ed-8d32a945e0ef}"
        }
    },
    "close_source_branch": false,
    "destination": {
        "branch": {
            "name": "yt"
        },
        "commit": {
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/commit/3215234b6e95"
                }
            },
            "hash": "3215234b6e95"
        },
        "repository": {
            "full_name": "yt_analysis/yt",
            "type": "repository",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt"
                },
                "avatar": {
                    "href": "https://bitbucket.org/yt_analysis/yt/avatar/32/"
                }
            },
            "name": "yt",
            "uuid": "{b73cb37c-40f2-493a-aaa9-41bc8d8974cc}"
        }
    },
    "comments": [
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/jzuhone"
                    },
                    "html": {
                        "href": "https://bitbucket.org/jzuhone/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/jzuhone/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "John ZuHone",
                "uuid": "{0c51edfa-e317-432f-bbef-7401c6e2aa8a}",
                "username": "jzuhone"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2213/comments/19385324"
                },
                "code": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/diff/ngoldbaum/yt:140413889207..27783a435b49?path=yt%2Fdata_objects%2Fstatic_output.py"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2213/_/diff#comment-19385324"
                }
            },
            "pullrequest": {
                "title": "MKS code unit system fixes. Closes #1229",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2213"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2213"
                    }
                },
                "id": 2213
            },
            "content": {
                "raw": "Was this a bug?",
                "html": "<p>Was this a bug?</p>",
                "markup": "markdown"
            },
            "created_on": "2016-06-06T17:04:15.814032+00:00",
            "updated_on": "2016-06-06T17:04:15.822324+00:00",
            "inline": {
                "from": null,
                "path": "yt/data_objects/static_output.py",
                "to": 893
            },
            "id": 19385324
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/ngoldbaum"
                    },
                    "html": {
                        "href": "https://bitbucket.org/ngoldbaum/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/ngoldbaum/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "Nathan Goldbaum",
                "uuid": "{5dcd72da-6420-4a6d-9571-e75dffcac587}",
                "username": "ngoldbaum"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2213/comments/19385391"
                },
                "code": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/diff/ngoldbaum/yt:None..None?path=yt%2Fdata_objects%2Fstatic_output.py"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2213/_/diff#comment-19385391"
                }
            },
            "parent": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2213/comments/19385324"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2213/_/diff#comment-19385324"
                    }
                },
                "id": 19385324
            },
            "pullrequest": {
                "title": "MKS code unit system fixes. Closes #1229",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2213"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2213"
                    }
                },
                "id": 2213
            },
            "content": {
                "raw": "Yup, revealed by running the test suite against this pull request.",
                "html": "<p>Yup, revealed by running the test suite against this pull request.</p>",
                "markup": "markdown"
            },
            "created_on": "2016-06-06T17:05:39.319168+00:00",
            "updated_on": "2016-06-06T17:05:39.324295+00:00",
            "inline": {
                "from": null,
                "path": "yt/data_objects/static_output.py",
                "to": null
            },
            "id": 19385391
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/jzuhone"
                    },
                    "html": {
                        "href": "https://bitbucket.org/jzuhone/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/jzuhone/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "John ZuHone",
                "uuid": "{0c51edfa-e317-432f-bbef-7401c6e2aa8a}",
                "username": "jzuhone"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2213/comments/19385423"
                },
                "code": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/diff/ngoldbaum/yt:None..None?path=yt%2Fdata_objects%2Fstatic_output.py"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2213/_/diff#comment-19385423"
                }
            },
            "parent": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2213/comments/19385391"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2213/_/diff#comment-19385391"
                    }
                },
                "id": 19385391
            },
            "pullrequest": {
                "title": "MKS code unit system fixes. Closes #1229",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2213"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2213"
                    }
                },
                "id": 2213
            },
            "content": {
                "raw": "Good catch!",
                "html": "<p>Good catch!</p>",
                "markup": "markdown"
            },
            "created_on": "2016-06-06T17:06:21.323663+00:00",
            "updated_on": "2016-06-06T17:06:21.330799+00:00",
            "inline": {
                "from": null,
                "path": "yt/data_objects/static_output.py",
                "to": null
            },
            "id": 19385423
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/jzuhone"
                    },
                    "html": {
                        "href": "https://bitbucket.org/jzuhone/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/jzuhone/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "John ZuHone",
                "uuid": "{0c51edfa-e317-432f-bbef-7401c6e2aa8a}",
                "username": "jzuhone"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2213/comments/19385897"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2213/_/diff#comment-19385897"
                }
            },
            "pullrequest": {
                "title": "MKS code unit system fixes. Closes #1229",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2213"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2213"
                    }
                },
                "id": 2213
            },
            "content": {
                "raw": "Looks good, we'll wait to see what happens when we can get a test run. \n\nAny impacts on performance? I doubt it, but just curious. ",
                "html": "<p>Looks good, we'll wait to see what happens when we can get a test run. </p>\n<p>Any impacts on performance? I doubt it, but just curious. </p>",
                "markup": "markdown"
            },
            "created_on": "2016-06-06T17:16:56.113884+00:00",
            "updated_on": "2016-06-06T17:16:56.115935+00:00",
            "id": 19385897
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/ngoldbaum"
                    },
                    "html": {
                        "href": "https://bitbucket.org/ngoldbaum/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/ngoldbaum/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "Nathan Goldbaum",
                "uuid": "{5dcd72da-6420-4a6d-9571-e75dffcac587}",
                "username": "ngoldbaum"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2213/comments/19387748"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2213/_/diff#comment-19387748"
                }
            },
            "parent": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2213/comments/19385897"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2213/_/diff#comment-19385897"
                    }
                },
                "id": 19385897
            },
            "pullrequest": {
                "title": "MKS code unit system fixes. Closes #1229",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2213"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2213"
                    }
                },
                "id": 2213
            },
            "content": {
                "raw": "I haven't carefully tested and we don't really have a benchmark setup so it's kind of a pain to systemtically compare performance. That said, I would be surprised if any of these changes had performance implications.",
                "html": "<p>I haven't carefully tested and we don't really have a benchmark setup so it's kind of a pain to systemtically compare performance. That said, I would be surprised if any of these changes had performance implications.</p>",
                "markup": "markdown"
            },
            "created_on": "2016-06-06T17:59:39.025760+00:00",
            "updated_on": "2016-06-06T17:59:39.029663+00:00",
            "id": 19387748
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/ngoldbaum"
                    },
                    "html": {
                        "href": "https://bitbucket.org/ngoldbaum/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/ngoldbaum/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "Nathan Goldbaum",
                "uuid": "{5dcd72da-6420-4a6d-9571-e75dffcac587}",
                "username": "ngoldbaum"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2213/comments/19463078"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2213/_/diff#comment-19463078"
                }
            },
            "pullrequest": {
                "title": "MKS code unit system fixes. Closes #1229",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2213"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2213"
                    }
                },
                "id": 2213
            },
            "content": {
                "raw": "We need to add `WDMerger_hdf5_chk_1000/WDMerger_hdf5_chk_1000.hdf5` to the test datasets the test machine sees.",
                "html": "<p>We need to add <code>WDMerger_hdf5_chk_1000/WDMerger_hdf5_chk_1000.hdf5</code> to the test datasets the test machine sees.</p>",
                "markup": "markdown"
            },
            "created_on": "2016-06-08T02:15:07.786304+00:00",
            "updated_on": "2016-06-08T02:15:07.791337+00:00",
            "id": 19463078
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/ngoldbaum"
                    },
                    "html": {
                        "href": "https://bitbucket.org/ngoldbaum/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/ngoldbaum/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "Nathan Goldbaum",
                "uuid": "{5dcd72da-6420-4a6d-9571-e75dffcac587}",
                "username": "ngoldbaum"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2213/comments/19810893"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2213/_/diff#comment-19810893"
                }
            },
            "pullrequest": {
                "title": "MKS code unit system fixes. Closes #1229",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2213"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2213"
                    }
                },
                "id": 2213
            },
            "content": {
                "raw": "This is currently blocked on [PR 2235](https://bitbucket.org/yt_analysis/yt/pull-requests/2235). Once that's merged in the tests should pass on this one.",
                "html": "<p>This is currently blocked on <a href=\"https://bitbucket.org/yt_analysis/yt/pull-requests/2235\">PR 2235</a>. Once that's merged in the tests should pass on this one.</p>",
                "markup": "markdown"
            },
            "created_on": "2016-06-15T19:44:12.315889+00:00",
            "updated_on": "2016-06-15T19:44:12.324061+00:00",
            "id": 19810893
        }
    ]
}