{
    "reason": "",
    "state": "OPEN",
    "updated_on": "2017-04-21T11:36:47.718554+00:00",
    "comment_count": 0,
    "description": "The current behavior of yt with respect to \"code\" unit systems to to permit switching a `YTArray` to a code unit system via something like:\r\n\r\n```python\r\nds = yt.load(\"my_dataset\")\r\nsp = ds.sphere(\"c\", (100.0, \"kpc\"))\r\nsp[\"density\"].in_base(ds)\r\n```\r\nwhich is a bit clunky and not terribly symmetric with the other ways of switching to different unit systems, e.g. `in_base(\"galactic\")`. In the current implementation, the code unit systems in the `unit_system_registry` are indexed by the string representation of the dataset. \r\n\r\nWith respect to this latter point, this is actually a problem, because for stream datasets this representation is actually the same for every dataset, so one would end up overwriting the unit system in the registry every time one opened a new one. The solution is for every dataset to have a unique identifier. \r\n\r\nSo that each dataset has a unique hash within the `unit_system_registry` dict, I've stolen the `fnv_hash` from `selection_routines` and placed it in a Cython file under `yt/utilities/lib`, and used it for this purpose. \r\n\r\nThe other benefit to this technique is that one can now use `in_base(\"code\")` for `YTArrays` with code units and it will work, in the same way as the other unit systems. \r\n\r\nI need to edit the docs, but otherwise this is ready for code review.",
    "created_on": "2017-04-15T03:20:02.301726+00:00",
    "task_count": 0,
    "merge_commit": null,
    "title": "Properly create code unit systems",
    "links": {
        "diff": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2580/diff"
        },
        "decline": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2580/decline"
        },
        "self": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2580"
        },
        "activity": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2580/activity"
        },
        "merge": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2580/merge"
        },
        "commits": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2580/commits"
        },
        "statuses": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2580/statuses"
        },
        "approve": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2580/approve"
        },
        "html": {
            "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2580"
        },
        "comments": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2580/comments"
        }
    },
    "closed_by": null,
    "id": 2580,
    "type": "pullrequest",
    "author": {
        "links": {
            "self": {
                "href": "https://api.bitbucket.org/2.0/users/jzuhone"
            },
            "html": {
                "href": "https://bitbucket.org/jzuhone/"
            },
            "avatar": {
                "href": "https://bitbucket.org/account/jzuhone/avatar/32/"
            }
        },
        "type": "user",
        "display_name": "John ZuHone",
        "uuid": "{0c51edfa-e317-432f-bbef-7401c6e2aa8a}",
        "username": "jzuhone"
    },
    "source": {
        "branch": {
            "name": "yt"
        },
        "commit": {
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/jzuhone/yt/commit/6b28977dbc64"
                }
            },
            "hash": "6b28977dbc64"
        },
        "repository": {
            "full_name": "jzuhone/yt",
            "type": "repository",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/jzuhone/yt"
                },
                "html": {
                    "href": "https://bitbucket.org/jzuhone/yt"
                },
                "avatar": {
                    "href": "https://bitbucket.org/jzuhone/yt/avatar/32/"
                }
            },
            "name": "yt",
            "uuid": "{aa71d2fb-24c5-4e74-8701-f32955348acf}"
        }
    },
    "close_source_branch": false,
    "destination": {
        "branch": {
            "name": "yt"
        },
        "commit": {
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/commit/634cc55bf066"
                }
            },
            "hash": "634cc55bf066"
        },
        "repository": {
            "full_name": "yt_analysis/yt",
            "type": "repository",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt"
                },
                "avatar": {
                    "href": "https://bitbucket.org/yt_analysis/yt/avatar/32/"
                }
            },
            "name": "yt",
            "uuid": "{b73cb37c-40f2-493a-aaa9-41bc8d8974cc}"
        }
    },
    "comments": []
}