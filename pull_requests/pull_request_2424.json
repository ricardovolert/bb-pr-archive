{
    "links": {
        "decline": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2424/decline"
        },
        "approve": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2424/approve"
        },
        "html": {
            "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2424"
        },
        "activity": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2424/activity"
        },
        "self": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2424"
        },
        "commits": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2424/commits"
        },
        "merge": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2424/merge"
        },
        "statuses": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2424/statuses"
        },
        "comments": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2424/comments"
        },
        "diff": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2424/diff"
        }
    },
    "task_count": 0,
    "source": {
        "repository": {
            "full_name": "ngoldbaum/yt",
            "uuid": "{cb18d7d9-ab77-4e80-81ed-8d32a945e0ef}",
            "type": "repository",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/ngoldbaum/yt"
                },
                "html": {
                    "href": "https://bitbucket.org/ngoldbaum/yt"
                },
                "avatar": {
                    "href": "https://bitbucket.org/ngoldbaum/yt/avatar/32/"
                }
            },
            "name": "yt"
        },
        "commit": {
            "hash": "54d6e0c0d528",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/ngoldbaum/yt/commit/54d6e0c0d528"
                }
            }
        },
        "branch": {
            "name": "yt"
        }
    },
    "closed_by": {
        "username": "MatthewTurk",
        "type": "user",
        "links": {
            "self": {
                "href": "https://api.bitbucket.org/2.0/users/MatthewTurk"
            },
            "html": {
                "href": "https://bitbucket.org/MatthewTurk/"
            },
            "avatar": {
                "href": "https://bitbucket.org/account/MatthewTurk/avatar/32/"
            }
        },
        "display_name": "Matt Turk",
        "uuid": "{b3f0b280-55fc-4e8a-8bd1-40478d4cbdbf}"
    },
    "title": "Implement equivalency keyword argument for PlotWindow.set_unit. Closes #1292",
    "id": 2424,
    "comment_count": 3,
    "created_on": "2016-10-24T20:42:02.718584+00:00",
    "merge_commit": {
        "hash": "76e74bb22aa0",
        "links": {
            "self": {
                "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/commit/76e74bb22aa0"
            }
        }
    },
    "comments": [
        {
            "content": {
                "markup": "markdown",
                "raw": "* Docs were built for this PR. See https://tests.yt-project.org/job/yt_docs/1297/. Docs build visible at https://tests.yt-project.org/job/yt_docs/1297/artifact/sandbox/doc/build/html/index.html\n* Docs were built for this PR. See https://tests.yt-project.org/job/yt_docs/1298/. Docs build visible at https://tests.yt-project.org/job/yt_docs/1298/artifact/sandbox/doc/build/html/index.html\n* Docs were built for this PR. See https://tests.yt-project.org/job/yt_docs/1319/. Docs build visible at https://tests.yt-project.org/job/yt_docs/1319/artifact/sandbox/doc/build/html/index.html\n",
                "html": "<ul>\n<li>Docs were built for this PR. See <a href=\"https://tests.yt-project.org/job/yt_docs/1297/\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_docs/1297/</a>. Docs build visible at <a href=\"https://tests.yt-project.org/job/yt_docs/1297/artifact/sandbox/doc/build/html/index.html\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_docs/1297/artifact/sandbox/doc/build/html/index.html</a></li>\n<li>Docs were built for this PR. See <a href=\"https://tests.yt-project.org/job/yt_docs/1298/\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_docs/1298/</a>. Docs build visible at <a href=\"https://tests.yt-project.org/job/yt_docs/1298/artifact/sandbox/doc/build/html/index.html\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_docs/1298/artifact/sandbox/doc/build/html/index.html</a></li>\n<li>Docs were built for this PR. See <a href=\"https://tests.yt-project.org/job/yt_docs/1319/\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_docs/1319/</a>. Docs build visible at <a href=\"https://tests.yt-project.org/job/yt_docs/1319/artifact/sandbox/doc/build/html/index.html\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_docs/1319/artifact/sandbox/doc/build/html/index.html</a></li>\n</ul>"
            },
            "user": {
                "username": "yt-fido",
                "type": "user",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/yt-fido"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt-fido/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/yt-fido/avatar/32/"
                    }
                },
                "display_name": "yt-fido",
                "uuid": "{da2aa332-3f05-45c9-ae53-ff5ba34b35ce}"
            },
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2424/comments/25673362"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2424/_/diff#comment-25673362"
                }
            },
            "created_on": "2016-10-24T22:07:03.954596+00:00",
            "updated_on": "2016-11-07T16:57:07.942523+00:00",
            "pullrequest": {
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2424"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2424"
                    }
                },
                "title": "Implement equivalency keyword argument for PlotWindow.set_unit. Closes #1292",
                "id": 2424
            },
            "type": "pullrequest_comment",
            "id": 25673362
        },
        {
            "content": {
                "markup": "markdown",
                "raw": "The example script you provide works fine! However, it seems that it does not work with *set_buff_size()*. For example, the following script failed.\n\n```\n#!python\n\nimport yt\nds = yt.load(\"IsolatedGalaxy/galaxy0030/galaxy0030\")\nslc = yt.SlicePlot(ds, 'z', 'temperature', width=(10,'kpc'))\nslc.set_unit('temperature', 'keV', equivalency='thermal')\n\n#this line causes a problem\nslc.set_buff_size(2048)\n\nslc.save()\n```\n\nError messages:\n\n```\n#!python\n\nTraceback (most recent call last):\n  File \"plot.py\", line 6, in <module>\n    slc.save()\n  File \"/projects/ncsa/grav/hyschive/yt/tmp3/yt/visualization/plot_container.py\", line 74, in newfunc\n    args[0]._recreate_frb()\n  File \"/projects/ncsa/grav/hyschive/yt/tmp3/yt/visualization/plot_window.py\", line 285, in _recreate_frb\n    self._frb[key].convert_to_units(unit)\n  File \"/projects/ncsa/grav/hyschive/yt/tmp3/yt/units/yt_array.py\", line 470, in convert_to_units\n    new_units = _unit_repr_check_same(self.units, units)\n  File \"/projects/ncsa/grav/hyschive/yt/tmp3/yt/utilities/lru_cache.py\", line 134, in wrapper\n    result = user_function(*args, **kwds)\n  File \"/projects/ncsa/grav/hyschive/yt/tmp3/yt/units/yt_array.py\", line 199, in _unit_repr_check_same\n    my_units, my_units.dimensions, other_units, other_units.dimensions)\nyt.utilities.exceptions.YTUnitConversionError: Unit dimensionalities do not match. Tried to convert between K (dim (temperature)) and keV (dim (length)**2*(mass)/(time)**2).\n```\n",
                "html": "<p>The example script you provide works fine! However, it seems that it does not work with <em>set_buff_size()</em>. For example, the following script failed.</p>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"kn\">import</span> <span class=\"nn\">yt</span>\n<span class=\"n\">ds</span> <span class=\"o\">=</span> <span class=\"n\">yt</span><span class=\"o\">.</span><span class=\"n\">load</span><span class=\"p\">(</span><span class=\"s2\">&quot;IsolatedGalaxy/galaxy0030/galaxy0030&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">slc</span> <span class=\"o\">=</span> <span class=\"n\">yt</span><span class=\"o\">.</span><span class=\"n\">SlicePlot</span><span class=\"p\">(</span><span class=\"n\">ds</span><span class=\"p\">,</span> <span class=\"s1\">&#39;z&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;temperature&#39;</span><span class=\"p\">,</span> <span class=\"n\">width</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">10</span><span class=\"p\">,</span><span class=\"s1\">&#39;kpc&#39;</span><span class=\"p\">))</span>\n<span class=\"n\">slc</span><span class=\"o\">.</span><span class=\"n\">set_unit</span><span class=\"p\">(</span><span class=\"s1\">&#39;temperature&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;keV&#39;</span><span class=\"p\">,</span> <span class=\"n\">equivalency</span><span class=\"o\">=</span><span class=\"s1\">&#39;thermal&#39;</span><span class=\"p\">)</span>\n\n<span class=\"c1\">#this line causes a problem</span>\n<span class=\"n\">slc</span><span class=\"o\">.</span><span class=\"n\">set_buff_size</span><span class=\"p\">(</span><span class=\"mi\">2048</span><span class=\"p\">)</span>\n\n<span class=\"n\">slc</span><span class=\"o\">.</span><span class=\"n\">save</span><span class=\"p\">()</span>\n</pre></div>\n\n\n<p>Error messages:</p>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"n\">Traceback</span> <span class=\"p\">(</span><span class=\"n\">most</span> <span class=\"n\">recent</span> <span class=\"n\">call</span> <span class=\"n\">last</span><span class=\"p\">):</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;plot.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">6</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"o\">&lt;</span><span class=\"n\">module</span><span class=\"o\">&gt;</span>\n    <span class=\"n\">slc</span><span class=\"o\">.</span><span class=\"n\">save</span><span class=\"p\">()</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/projects/ncsa/grav/hyschive/yt/tmp3/yt/visualization/plot_container.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">74</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">newfunc</span>\n    <span class=\"n\">args</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">_recreate_frb</span><span class=\"p\">()</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/projects/ncsa/grav/hyschive/yt/tmp3/yt/visualization/plot_window.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">285</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">_recreate_frb</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_frb</span><span class=\"p\">[</span><span class=\"n\">key</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">convert_to_units</span><span class=\"p\">(</span><span class=\"n\">unit</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/projects/ncsa/grav/hyschive/yt/tmp3/yt/units/yt_array.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">470</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">convert_to_units</span>\n    <span class=\"n\">new_units</span> <span class=\"o\">=</span> <span class=\"n\">_unit_repr_check_same</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">units</span><span class=\"p\">,</span> <span class=\"n\">units</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/projects/ncsa/grav/hyschive/yt/tmp3/yt/utilities/lru_cache.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">134</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">wrapper</span>\n    <span class=\"n\">result</span> <span class=\"o\">=</span> <span class=\"n\">user_function</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">args</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kwds</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/projects/ncsa/grav/hyschive/yt/tmp3/yt/units/yt_array.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">199</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">_unit_repr_check_same</span>\n    <span class=\"n\">my_units</span><span class=\"p\">,</span> <span class=\"n\">my_units</span><span class=\"o\">.</span><span class=\"n\">dimensions</span><span class=\"p\">,</span> <span class=\"n\">other_units</span><span class=\"p\">,</span> <span class=\"n\">other_units</span><span class=\"o\">.</span><span class=\"n\">dimensions</span><span class=\"p\">)</span>\n<span class=\"n\">yt</span><span class=\"o\">.</span><span class=\"n\">utilities</span><span class=\"o\">.</span><span class=\"n\">exceptions</span><span class=\"o\">.</span><span class=\"n\">YTUnitConversionError</span><span class=\"p\">:</span> <span class=\"n\">Unit</span> <span class=\"n\">dimensionalities</span> <span class=\"n\">do</span> <span class=\"ow\">not</span> <span class=\"n\">match</span><span class=\"o\">.</span> <span class=\"n\">Tried</span> <span class=\"n\">to</span> <span class=\"n\">convert</span> <span class=\"n\">between</span> <span class=\"n\">K</span> <span class=\"p\">(</span><span class=\"n\">dim</span> <span class=\"p\">(</span><span class=\"n\">temperature</span><span class=\"p\">))</span> <span class=\"ow\">and</span> <span class=\"n\">keV</span> <span class=\"p\">(</span><span class=\"n\">dim</span> <span class=\"p\">(</span><span class=\"n\">length</span><span class=\"p\">)</span><span class=\"o\">**</span><span class=\"mi\">2</span><span class=\"o\">*</span><span class=\"p\">(</span><span class=\"n\">mass</span><span class=\"p\">)</span><span class=\"o\">/</span><span class=\"p\">(</span><span class=\"n\">time</span><span class=\"p\">)</span><span class=\"o\">**</span><span class=\"mi\">2</span><span class=\"p\">)</span><span class=\"o\">.</span>\n</pre></div>"
            },
            "user": {
                "username": "hyschive",
                "type": "user",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/hyschive"
                    },
                    "html": {
                        "href": "https://bitbucket.org/hyschive/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/hyschive/avatar/32/"
                    }
                },
                "display_name": "Hsi-Yu Schive",
                "uuid": "{546998cc-8f7a-492a-8abf-fc1178e6d0fd}"
            },
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2424/comments/26186655"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2424/_/diff#comment-26186655"
                }
            },
            "created_on": "2016-11-02T22:33:15.049002+00:00",
            "updated_on": "2016-11-02T22:33:15.181652+00:00",
            "pullrequest": {
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2424"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2424"
                    }
                },
                "title": "Implement equivalency keyword argument for PlotWindow.set_unit. Closes #1292",
                "id": 2424
            },
            "type": "pullrequest_comment",
            "id": 26186655
        },
        {
            "content": {
                "markup": "markdown",
                "raw": "I think I know why this is happening. Thanks for giving this a test!",
                "html": "<p>I think I know why this is happening. Thanks for giving this a test!</p>"
            },
            "user": {
                "username": "ngoldbaum",
                "type": "user",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/ngoldbaum"
                    },
                    "html": {
                        "href": "https://bitbucket.org/ngoldbaum/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/ngoldbaum/avatar/32/"
                    }
                },
                "display_name": "Nathan Goldbaum",
                "uuid": "{5dcd72da-6420-4a6d-9571-e75dffcac587}"
            },
            "parent": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2424/comments/26186655"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2424/_/diff#comment-26186655"
                    }
                },
                "id": 26186655
            },
            "created_on": "2016-11-03T00:28:49.105490+00:00",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2424/comments/26190533"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2424/_/diff#comment-26190533"
                }
            },
            "pullrequest": {
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2424"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2424"
                    }
                },
                "title": "Implement equivalency keyword argument for PlotWindow.set_unit. Closes #1292",
                "id": 2424
            },
            "type": "pullrequest_comment",
            "id": 26190533,
            "updated_on": "2016-11-03T00:28:49.110799+00:00"
        }
    ],
    "reason": "",
    "type": "pullrequest",
    "close_source_branch": false,
    "state": "MERGED",
    "description": "This implements the ability to set the units of a PlotWindow plot via an equivalency.\r\n\r\nI've opted not to to do the same thing for ProfilePlot and PhasePlot yet, since that will require a deeper refactoring of the way `ProfileND` object handle field units.\r\n\r\nIn addition, I fixed a bug in a corner case of the unit equivalency implementation that might cause `YTArray` subclasses to silently convert to `YTArray`.\r\n\r\nI've also added documentation and tests for `PlotWindow.set_unit`, which were missing before.",
    "author": {
        "username": "ngoldbaum",
        "type": "user",
        "links": {
            "self": {
                "href": "https://api.bitbucket.org/2.0/users/ngoldbaum"
            },
            "html": {
                "href": "https://bitbucket.org/ngoldbaum/"
            },
            "avatar": {
                "href": "https://bitbucket.org/account/ngoldbaum/avatar/32/"
            }
        },
        "display_name": "Nathan Goldbaum",
        "uuid": "{5dcd72da-6420-4a6d-9571-e75dffcac587}"
    },
    "updated_on": "2016-11-18T16:08:14.586684+00:00",
    "destination": {
        "repository": {
            "full_name": "yt_analysis/yt",
            "uuid": "{b73cb37c-40f2-493a-aaa9-41bc8d8974cc}",
            "type": "repository",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt"
                },
                "avatar": {
                    "href": "https://bitbucket.org/yt_analysis/yt/avatar/32/"
                }
            },
            "name": "yt"
        },
        "commit": {
            "hash": "5084dbec0f1d",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/commit/5084dbec0f1d"
                }
            }
        },
        "branch": {
            "name": "yt"
        }
    }
}