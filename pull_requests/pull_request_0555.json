{
    "reason": "",
    "state": "MERGED",
    "updated_on": "2013-07-19T13:37:43.085813+00:00",
    "comment_count": 5,
    "description": "This PR is composed of two related changesets so I'm bundling them even though they correspond to different parts of the codebase.\r\n\r\nFirst, I've gone through the IPython imports and updated them wherever necessary.  This is due to a recent change in IPython's internal namespaces.  I've tested this in 0.13.2 and 1.0dev and everything seems to work correctly.  There are a ton of ways we can get into IPython but I think I've gone through and tested all the ones I changed to make sure everything still works on both versions.\r\n\r\nSecond, this modifies the `__repr__` method of plot window plots so that they display inside the notebook in a very natural way.  Take a look at this notebook to see what I mean:\r\n\r\nhttp://nbviewer.ipython.org/url/hub.yt-project.org/notebooks/fe0400deaec149a5b886e5a0c875f2b0.ipynb\r\n\r\nI think a similar notebook written with the current tip would have required an additional 2-3 more lines.  This does change the plotting semantics a tiny bit, since I modified `pan`, and `zoom`, so please let me know if you spot any gotchas.",
    "created_on": "2013-07-16T00:44:19.183985+00:00",
    "task_count": 0,
    "merge_commit": {
        "links": {
            "self": {
                "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/commit/e3e4f4578504"
            }
        },
        "hash": "e3e4f4578504"
    },
    "title": "IPython 1.0 support and improved plotting inside the notebook.",
    "links": {
        "diff": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/555/diff"
        },
        "decline": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/555/decline"
        },
        "self": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/555"
        },
        "activity": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/555/activity"
        },
        "merge": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/555/merge"
        },
        "commits": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/555/commits"
        },
        "statuses": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/555/statuses"
        },
        "approve": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/555/approve"
        },
        "html": {
            "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/555"
        },
        "comments": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/555/comments"
        }
    },
    "closed_by": {
        "links": {
            "self": {
                "href": "https://api.bitbucket.org/2.0/users/MatthewTurk"
            },
            "html": {
                "href": "https://bitbucket.org/MatthewTurk/"
            },
            "avatar": {
                "href": "https://bitbucket.org/account/MatthewTurk/avatar/32/"
            }
        },
        "type": "user",
        "display_name": "Matt Turk",
        "uuid": "{b3f0b280-55fc-4e8a-8bd1-40478d4cbdbf}",
        "username": "MatthewTurk"
    },
    "id": 555,
    "type": "pullrequest",
    "author": {
        "links": {
            "self": {
                "href": "https://api.bitbucket.org/2.0/users/ngoldbaum"
            },
            "html": {
                "href": "https://bitbucket.org/ngoldbaum/"
            },
            "avatar": {
                "href": "https://bitbucket.org/account/ngoldbaum/avatar/32/"
            }
        },
        "type": "user",
        "display_name": "Nathan Goldbaum",
        "uuid": "{5dcd72da-6420-4a6d-9571-e75dffcac587}",
        "username": "ngoldbaum"
    },
    "source": {
        "branch": {
            "name": "yt"
        },
        "commit": {
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/ngoldbaum/yt/commit/c8ce7b6481b2"
                }
            },
            "hash": "c8ce7b6481b2"
        },
        "repository": {
            "full_name": "ngoldbaum/yt",
            "type": "repository",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/ngoldbaum/yt"
                },
                "html": {
                    "href": "https://bitbucket.org/ngoldbaum/yt"
                },
                "avatar": {
                    "href": "https://bitbucket.org/ngoldbaum/yt/avatar/32/"
                }
            },
            "name": "yt",
            "uuid": "{cb18d7d9-ab77-4e80-81ed-8d32a945e0ef}"
        }
    },
    "close_source_branch": false,
    "destination": {
        "branch": {
            "name": "yt"
        },
        "commit": {
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/commit/fe5d507ced3d"
                }
            },
            "hash": "fe5d507ced3d"
        },
        "repository": {
            "full_name": "yt_analysis/yt",
            "type": "repository",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt"
                },
                "avatar": {
                    "href": "https://bitbucket.org/yt_analysis/yt/avatar/32/"
                }
            },
            "name": "yt",
            "uuid": "{b73cb37c-40f2-493a-aaa9-41bc8d8974cc}"
        }
    },
    "comments": [
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/MatthewTurk"
                    },
                    "html": {
                        "href": "https://bitbucket.org/MatthewTurk/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/MatthewTurk/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "Matthew Turk",
                "uuid": "{b3f0b280-55fc-4e8a-8bd1-40478d4cbdbf}",
                "username": "MatthewTurk"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/555/comments/394430"
                },
                "code": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/diff/ngoldbaum/yt:c8ce7b6481b2..fe5d507ced3d?path=yt%2Fvisualization%2Fplot_window.py"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/555/_/diff#comment-394430"
                }
            },
            "pullrequest": {
                "title": "IPython 1.0 support and improved plotting inside the notebook.",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/555"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/555"
                    }
                },
                "id": 555
            },
            "content": {
                "raw": "There is also the config option `ytcfg[\"yt\",\"ipython_notebook\"]`.  The upside of this is that it is only set if importing from `imods`.  The downside is that it is only set if importing from `imods`.  I'm +0 on switching to it.",
                "html": "<p>There is also the config option <code>ytcfg[\"yt\",\"ipython_notebook\"]</code>.  The upside of this is that it is only set if importing from <code>imods</code>.  The downside is that it is only set if importing from <code>imods</code>.  I'm +0 on switching to it.</p>",
                "markup": "markdown"
            },
            "created_on": "2013-07-19T00:43:26.915838+00:00",
            "updated_on": "2013-07-19T00:43:26.933885+00:00",
            "inline": {
                "from": null,
                "path": "yt/visualization/plot_window.py",
                "to": 1116
            },
            "id": 394430
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/MatthewTurk"
                    },
                    "html": {
                        "href": "https://bitbucket.org/MatthewTurk/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/MatthewTurk/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "Matthew Turk",
                "uuid": "{b3f0b280-55fc-4e8a-8bd1-40478d4cbdbf}",
                "username": "MatthewTurk"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/555/comments/394431"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/555/_/diff#comment-394431"
                }
            },
            "pullrequest": {
                "title": "IPython 1.0 support and improved plotting inside the notebook.",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/555"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/555"
                    }
                },
                "id": 555
            },
            "content": {
                "raw": "Awesome work, @ngoldbaum .  Other than my one comment, which may not need a change, I'm ready for this to go in.",
                "html": "<p>Awesome work, <a href=\"/ngoldbaum/\" rel=\"nofollow\" title=\"@ngoldbaum\" class=\"mention\">Nathan Goldbaum</a> .  Other than my one comment, which may not need a change, I'm ready for this to go in.</p>",
                "markup": "markdown"
            },
            "created_on": "2013-07-19T00:43:55.944118+00:00",
            "updated_on": "2013-07-19T00:43:55.964250+00:00",
            "id": 394431
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/ngoldbaum"
                    },
                    "html": {
                        "href": "https://bitbucket.org/ngoldbaum/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/ngoldbaum/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "Nathan Goldbaum",
                "uuid": "{5dcd72da-6420-4a6d-9571-e75dffcac587}",
                "username": "ngoldbaum"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/555/comments/394776"
                },
                "code": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/diff/ngoldbaum/yt:None..None?path=yt%2Fvisualization%2Fplot_window.py"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/555/_/diff#comment-394776"
                }
            },
            "parent": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/555/comments/394430"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/555/_/diff#comment-394430"
                    }
                },
                "id": 394430
            },
            "pullrequest": {
                "title": "IPython 1.0 support and improved plotting inside the notebook.",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/555"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/555"
                    }
                },
                "id": 555
            },
            "content": {
                "raw": "Since imods raises an `ImportError` if `__IPYTHON__` is not in `dir(__builtin__)`, that means that `ytcfg[\"yt\",\"ipython_notebook\"]` should be equivalent to the check I already have, except that it won't do the expected thing if someone doesn't explicitly import from imods.\n\nFWIW, we do the `__IPYTHON__` check four other places in the codebase and never check whether `ytcfg[\"yt\",\"ipython_notebook\"]` is set.  Perhaps we should figure out if there is a canonical way of checking if we've been imported inside of a notebook session and just use that in all cases rather than relying on the imods import to turn on functionality that can work regardless of the special things we do in imods. ",
                "html": "<p>Since imods raises an <code>ImportError</code> if <code>__IPYTHON__</code> is not in <code>dir(__builtin__)</code>, that means that <code>ytcfg[\"yt\",\"ipython_notebook\"]</code> should be equivalent to the check I already have, except that it won't do the expected thing if someone doesn't explicitly import from imods.</p>\n<p>FWIW, we do the <code>__IPYTHON__</code> check four other places in the codebase and never check whether <code>ytcfg[\"yt\",\"ipython_notebook\"]</code> is set.  Perhaps we should figure out if there is a canonical way of checking if we've been imported inside of a notebook session and just use that in all cases rather than relying on the imods import to turn on functionality that can work regardless of the special things we do in imods. </p>",
                "markup": "markdown"
            },
            "created_on": "2013-07-19T05:00:23.637135+00:00",
            "updated_on": "2013-07-19T05:00:48.157515+00:00",
            "inline": {
                "from": null,
                "path": "yt/visualization/plot_window.py",
                "to": null
            },
            "id": 394776
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/MatthewTurk"
                    },
                    "html": {
                        "href": "https://bitbucket.org/MatthewTurk/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/MatthewTurk/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "Matthew Turk",
                "uuid": "{b3f0b280-55fc-4e8a-8bd1-40478d4cbdbf}",
                "username": "MatthewTurk"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/555/comments/395629"
                },
                "code": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/diff/ngoldbaum/yt:None..None?path=yt%2Fvisualization%2Fplot_window.py"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/555/_/diff#comment-395629"
                }
            },
            "parent": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/555/comments/394776"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/555/_/diff#comment-394776"
                    }
                },
                "id": 394776
            },
            "pullrequest": {
                "title": "IPython 1.0 support and improved plotting inside the notebook.",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/555"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/555"
                    }
                },
                "id": 555
            },
            "content": {
                "raw": "Okay, fair point.  One last question before accepting.  Because this overrides `__repr__` and because I think `__IPYTHON__` is defined even in shell IPython sessions (where we'd then be importing 0MQ, sending, etc etc), is there a way we could perhaps instead call this inside `__repr_html__`, which should only be called when such an operation would succeed?",
                "html": "<p>Okay, fair point.  One last question before accepting.  Because this overrides <code>__repr__</code> and because I think <code>__IPYTHON__</code> is defined even in shell IPython sessions (where we'd then be importing 0MQ, sending, etc etc), is there a way we could perhaps instead call this inside <code>__repr_html__</code>, which should only be called when such an operation would succeed?</p>",
                "markup": "markdown"
            },
            "created_on": "2013-07-19T12:18:19.848339+00:00",
            "updated_on": "2013-07-19T12:18:19.855757+00:00",
            "inline": {
                "from": null,
                "path": "yt/visualization/plot_window.py",
                "to": null
            },
            "id": 395629
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/MatthewTurk"
                    },
                    "html": {
                        "href": "https://bitbucket.org/MatthewTurk/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/MatthewTurk/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "Matthew Turk",
                "uuid": "{b3f0b280-55fc-4e8a-8bd1-40478d4cbdbf}",
                "username": "MatthewTurk"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/555/comments/395807"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/555/_/diff#comment-395807"
                }
            },
            "pullrequest": {
                "title": "IPython 1.0 support and improved plotting inside the notebook.",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/555"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/555"
                    }
                },
                "id": 555
            },
            "content": {
                "raw": "@ngoldbaum and I chatted in IRC and he explained that this works just fine and dandy in the terminal.  Thanks, Nathan!",
                "html": "<p><a href=\"/ngoldbaum/\" rel=\"nofollow\" title=\"@ngoldbaum\" class=\"mention\">Nathan Goldbaum</a> and I chatted in IRC and he explained that this works just fine and dandy in the terminal.  Thanks, Nathan!</p>",
                "markup": "markdown"
            },
            "created_on": "2013-07-19T13:37:36.480216+00:00",
            "updated_on": "2013-07-19T13:37:36.502431+00:00",
            "id": 395807
        }
    ]
}