{
    "reason": "",
    "state": "MERGED",
    "updated_on": "2016-09-07T18:06:10.507513+00:00",
    "comment_count": 24,
    "description": "This PR combines PR #2336 with #2315.\r\n\r\nLightRay enhancements:\r\n\r\n1. The ability to generate LightRays using only the high resolution portion of a zoom-in simulation.\r\n\r\n2. The ability to toggle between periodic and non-periodic ray segments.\r\n\r\n3. The ability to create a compound light ray with a single, continuous trajectory.\r\n\r\n4. This also slightly refactors some of the light ray solution calculation make it work better with unitful boundaries.\r\n\r\nBugfix:\r\n\r\nThis is the least invasive fix for Issue #1258 that I can think of. The crux of this is no longer passing a dataset's unit_registry to the cosmology calculator, allowing it to maintain its own unit system where the comoving and proper frames are equal to each other. This is how things were being done for compound light rays (from multiple datasets) and the like and this change just makes the behavior of simple light rays (from single datasets) consistent with that.\r\nIn addition to this, I have removed two instances of identical code and replaced with a call to a single function, deltaz_forward. I have also changed deltaz_forward to take a smarter initial guess using Hubble's Law instead of a constant value. Also, make sure that all omega values are floats, which wasn't the case.",
    "created_on": "2016-08-19T13:02:40.845201+00:00",
    "task_count": 0,
    "merge_commit": {
        "links": {
            "self": {
                "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/commit/4bc8ace93fda"
            }
        },
        "hash": "4bc8ace93fda"
    },
    "title": "LightRay enhancements and bugfix (closes Issue #1258)",
    "links": {
        "diff": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/diff"
        },
        "decline": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/decline"
        },
        "self": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345"
        },
        "activity": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/activity"
        },
        "merge": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/merge"
        },
        "commits": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/commits"
        },
        "statuses": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/statuses"
        },
        "approve": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/approve"
        },
        "html": {
            "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345"
        },
        "comments": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments"
        }
    },
    "closed_by": {
        "links": {
            "self": {
                "href": "https://api.bitbucket.org/2.0/users/ngoldbaum"
            },
            "html": {
                "href": "https://bitbucket.org/ngoldbaum/"
            },
            "avatar": {
                "href": "https://bitbucket.org/account/ngoldbaum/avatar/32/"
            }
        },
        "type": "user",
        "display_name": "Nathan Goldbaum",
        "uuid": "{5dcd72da-6420-4a6d-9571-e75dffcac587}",
        "username": "ngoldbaum"
    },
    "id": 2345,
    "type": "pullrequest",
    "author": {
        "links": {
            "self": {
                "href": "https://api.bitbucket.org/2.0/users/brittonsmith"
            },
            "html": {
                "href": "https://bitbucket.org/brittonsmith/"
            },
            "avatar": {
                "href": "https://bitbucket.org/account/brittonsmith/avatar/32/"
            }
        },
        "type": "user",
        "display_name": "Britton Smith",
        "uuid": "{94333901-a436-4c2c-8322-8d09e387eece}",
        "username": "brittonsmith"
    },
    "source": {
        "branch": {
            "name": "yt"
        },
        "commit": {
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/brittonsmith/yt/commit/434a048e99b6"
                }
            },
            "hash": "434a048e99b6"
        },
        "repository": {
            "full_name": "brittonsmith/yt",
            "type": "repository",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/brittonsmith/yt"
                },
                "html": {
                    "href": "https://bitbucket.org/brittonsmith/yt"
                },
                "avatar": {
                    "href": "https://bitbucket.org/brittonsmith/yt/avatar/32/"
                }
            },
            "name": "yt",
            "uuid": "{a3a98ec1-6936-4db5-8667-658e17c1eaca}"
        }
    },
    "close_source_branch": false,
    "destination": {
        "branch": {
            "name": "yt"
        },
        "commit": {
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/commit/9ccda6b503c6"
                }
            },
            "hash": "9ccda6b503c6"
        },
        "repository": {
            "full_name": "yt_analysis/yt",
            "type": "repository",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt"
                },
                "avatar": {
                    "href": "https://bitbucket.org/yt_analysis/yt/avatar/32/"
                }
            },
            "name": "yt",
            "uuid": "{b73cb37c-40f2-493a-aaa9-41bc8d8974cc}"
        }
    },
    "comments": [
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/yt-fido"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt-fido/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/yt-fido/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "yt-fido",
                "uuid": "{da2aa332-3f05-45c9-ae53-ff5ba34b35ce}",
                "username": "yt-fido"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/22597804"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-22597804"
                }
            },
            "pullrequest": {
                "title": "LightRay enhancements and bugfix (closes Issue #1258)",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345"
                    }
                },
                "id": 2345
            },
            "content": {
                "raw": "Docs were built for this PR. See https://tests.yt-project.org/job/yt_docs/1159/\nDocs build visible at https://tests.yt-project.org/job/yt_docs/1159/artifact/sandbox/doc/build/html/index.html",
                "html": "<p>Docs were built for this PR. See <a href=\"https://tests.yt-project.org/job/yt_docs/1159/\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_docs/1159/</a>\nDocs build visible at <a href=\"https://tests.yt-project.org/job/yt_docs/1159/artifact/sandbox/doc/build/html/index.html\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_docs/1159/artifact/sandbox/doc/build/html/index.html</a></p>",
                "markup": "markdown"
            },
            "created_on": "2016-08-19T15:47:34.277842+00:00",
            "updated_on": "2016-08-19T15:47:34.344598+00:00",
            "id": 22597804
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/yt-fido"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt-fido/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/yt-fido/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "yt-fido",
                "uuid": "{da2aa332-3f05-45c9-ae53-ff5ba34b35ce}",
                "username": "yt-fido"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/22602148"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-22602148"
                }
            },
            "pullrequest": {
                "title": "LightRay enhancements and bugfix (closes Issue #1258)",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345"
                    }
                },
                "id": 2345
            },
            "content": {
                "raw": "Docs were built for this PR. See https://tests.yt-project.org/job/yt_docs/1160/\nDocs build visible at https://tests.yt-project.org/job/yt_docs/1160/artifact/sandbox/doc/build/html/index.html",
                "html": "<p>Docs were built for this PR. See <a href=\"https://tests.yt-project.org/job/yt_docs/1160/\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_docs/1160/</a>\nDocs build visible at <a href=\"https://tests.yt-project.org/job/yt_docs/1160/artifact/sandbox/doc/build/html/index.html\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_docs/1160/artifact/sandbox/doc/build/html/index.html</a></p>",
                "markup": "markdown"
            },
            "created_on": "2016-08-19T17:14:07.043570+00:00",
            "updated_on": "2016-08-19T17:14:07.132985+00:00",
            "id": 22602148
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/yt-fido"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt-fido/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/yt-fido/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "yt-fido",
                "uuid": "{da2aa332-3f05-45c9-ae53-ff5ba34b35ce}",
                "username": "yt-fido"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/22737219"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-22737219"
                }
            },
            "pullrequest": {
                "title": "LightRay enhancements and bugfix (closes Issue #1258)",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345"
                    }
                },
                "id": 2345
            },
            "content": {
                "raw": "Docs were built for this PR. See https://tests.yt-project.org/job/yt_docs/1166/\nDocs build visible at https://tests.yt-project.org/job/yt_docs/1166/artifact/sandbox/doc/build/html/index.html",
                "html": "<p>Docs were built for this PR. See <a href=\"https://tests.yt-project.org/job/yt_docs/1166/\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_docs/1166/</a>\nDocs build visible at <a href=\"https://tests.yt-project.org/job/yt_docs/1166/artifact/sandbox/doc/build/html/index.html\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_docs/1166/artifact/sandbox/doc/build/html/index.html</a></p>",
                "markup": "markdown"
            },
            "created_on": "2016-08-23T18:15:56.698005+00:00",
            "updated_on": "2016-08-23T18:15:56.789735+00:00",
            "id": 22737219
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/yt-fido"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt-fido/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/yt-fido/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "yt-fido",
                "uuid": "{da2aa332-3f05-45c9-ae53-ff5ba34b35ce}",
                "username": "yt-fido"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/22741767"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-22741767"
                }
            },
            "pullrequest": {
                "title": "LightRay enhancements and bugfix (closes Issue #1258)",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345"
                    }
                },
                "id": 2345
            },
            "content": {
                "raw": "Docs were built for this PR. See https://tests.yt-project.org/job/yt_docs/1167/\nDocs build visible at https://tests.yt-project.org/job/yt_docs/1167/artifact/sandbox/doc/build/html/index.html",
                "html": "<p>Docs were built for this PR. See <a href=\"https://tests.yt-project.org/job/yt_docs/1167/\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_docs/1167/</a>\nDocs build visible at <a href=\"https://tests.yt-project.org/job/yt_docs/1167/artifact/sandbox/doc/build/html/index.html\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_docs/1167/artifact/sandbox/doc/build/html/index.html</a></p>",
                "markup": "markdown"
            },
            "created_on": "2016-08-23T19:41:46.791075+00:00",
            "updated_on": "2016-08-23T19:41:46.861669+00:00",
            "id": 22741767
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/yt-fido"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt-fido/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/yt-fido/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "yt-fido",
                "uuid": "{da2aa332-3f05-45c9-ae53-ff5ba34b35ce}",
                "username": "yt-fido"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/22766682"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-22766682"
                }
            },
            "pullrequest": {
                "title": "LightRay enhancements and bugfix (closes Issue #1258)",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345"
                    }
                },
                "id": 2345
            },
            "content": {
                "raw": "Docs were built for this PR. See https://tests.yt-project.org/job/yt_docs/1169/\nDocs build visible at https://tests.yt-project.org/job/yt_docs/1169/artifact/sandbox/doc/build/html/index.html",
                "html": "<p>Docs were built for this PR. See <a href=\"https://tests.yt-project.org/job/yt_docs/1169/\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_docs/1169/</a>\nDocs build visible at <a href=\"https://tests.yt-project.org/job/yt_docs/1169/artifact/sandbox/doc/build/html/index.html\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_docs/1169/artifact/sandbox/doc/build/html/index.html</a></p>",
                "markup": "markdown"
            },
            "created_on": "2016-08-24T08:45:46.922071+00:00",
            "updated_on": "2016-08-24T08:45:47.003022+00:00",
            "id": 22766682
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/chummels"
                    },
                    "html": {
                        "href": "https://bitbucket.org/chummels/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/chummels/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "chummels",
                "uuid": "{de871bb8-32e9-450a-b8c9-2b49a1334f16}",
                "username": "chummels"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/22799237"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-22799237"
                }
            },
            "pullrequest": {
                "title": "LightRay enhancements and bugfix (closes Issue #1258)",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345"
                    }
                },
                "id": 2345
            },
            "content": {
                "raw": "I cannot speak to all of the errors, but when I run nose locally on your PR head versus the repo head, I get an error for the test that I just added as part of Pull Request #2344 that was added yesterday.  \n\nThis test, `yt.analysis_modules.absorption_spectrum.tests.test_absorption_spectrum.test_absorption_spectrum_with_zero_field` (which is essentially the test script from Issue #1232) is failing because the constructed LightRay is only passing through a single-zone which has a temperature value of zero.  You can see this here in the latest test results for your PR: https://tests.yt-project.org/job/yt_py35/751/testReport/yt.analysis_modules.absorption_spectrum.tests/test_absorption_spectrum/test_absorption_spectrum_with_zero_field/ .  \n\nWhat's strange about this is that in that test, I explicitly made the LightRay pass through the full dimensions of the FIRE dataset, as suggested by @ngoldbaum in Issue #1232 using the `'unitary'` unit system:\n\n\n```\n#!python\n\nlr.make_light_ray(\n    #start_position=c,\n    start_position=ds.arr([0., 0., 0.], 'unitary'),\n    end_position=ds.arr([1., 1., 1.], 'unitary'),\n    solution_filename='test_lightraysolution.txt',\n    data_filename='test_lightray.h5',\n    fields=fields)\n```\n\nWhen I run this test on the tip of yt-dev, it picks up that there are 116 cells in the LightRay object, not just a single cell.  It doesn't fail because a handful of these cells have non-zero temperature values, whereas in your version of the code, it only finds the single cell with a zero temperature value.  I'm not sure why your version of the code would take the code snippet above for the FIRE dataset and only find a single cell--is it somehow disregarding the `'unitary'` unit system in lieu of using `'code_length'`?",
                "html": "<p>I cannot speak to all of the errors, but when I run nose locally on your PR head versus the repo head, I get an error for the test that I just added as part of <a href=\"/yt_analysis/yt/pull-requests/2344/bugfix-prevents-overmasking-of-lightray\" rel=\"nofollow\">pull request #2344</a> that was added yesterday.  </p>\n<p>This test, <code>yt.analysis_modules.absorption_spectrum.tests.test_absorption_spectrum.test_absorption_spectrum_with_zero_field</code> (which is essentially the test script from Issue <a href=\"/yt_analysis/yt/issues/1232/absorption-spectrum-produces-invalid\" rel=\"nofollow\" title=\"Absorption Spectrum produces invalid virtual bins\"><s>#1232</s></a>) is failing because the constructed LightRay is only passing through a single-zone which has a temperature value of zero.  You can see this here in the latest test results for your PR: <a href=\"https://tests.yt-project.org/job/yt_py35/751/testReport/yt.analysis_modules.absorption_spectrum.tests/test_absorption_spectrum/test_absorption_spectrum_with_zero_field/\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_py35/751/testReport/yt.analysis_modules.absorption_spectrum.tests/test_absorption_spectrum/test_absorption_spectrum_with_zero_field/</a> .  </p>\n<p>What's strange about this is that in that test, I explicitly made the LightRay pass through the full dimensions of the FIRE dataset, as suggested by <a href=\"/ngoldbaum/\" rel=\"nofollow\" title=\"@ngoldbaum\" class=\"mention\">Nathan Goldbaum</a> in Issue <a href=\"/yt_analysis/yt/issues/1232/absorption-spectrum-produces-invalid\" rel=\"nofollow\" title=\"Absorption Spectrum produces invalid virtual bins\"><s>#1232</s></a> using the <code>'unitary'</code> unit system:</p>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"n\">lr</span><span class=\"o\">.</span><span class=\"n\">make_light_ray</span><span class=\"p\">(</span>\n    <span class=\"c1\">#start_position=c,</span>\n    <span class=\"n\">start_position</span><span class=\"o\">=</span><span class=\"n\">ds</span><span class=\"o\">.</span><span class=\"n\">arr</span><span class=\"p\">([</span><span class=\"mf\">0.</span><span class=\"p\">,</span> <span class=\"mf\">0.</span><span class=\"p\">,</span> <span class=\"mf\">0.</span><span class=\"p\">],</span> <span class=\"s1\">&#39;unitary&#39;</span><span class=\"p\">),</span>\n    <span class=\"n\">end_position</span><span class=\"o\">=</span><span class=\"n\">ds</span><span class=\"o\">.</span><span class=\"n\">arr</span><span class=\"p\">([</span><span class=\"mf\">1.</span><span class=\"p\">,</span> <span class=\"mf\">1.</span><span class=\"p\">,</span> <span class=\"mf\">1.</span><span class=\"p\">],</span> <span class=\"s1\">&#39;unitary&#39;</span><span class=\"p\">),</span>\n    <span class=\"n\">solution_filename</span><span class=\"o\">=</span><span class=\"s1\">&#39;test_lightraysolution.txt&#39;</span><span class=\"p\">,</span>\n    <span class=\"n\">data_filename</span><span class=\"o\">=</span><span class=\"s1\">&#39;test_lightray.h5&#39;</span><span class=\"p\">,</span>\n    <span class=\"n\">fields</span><span class=\"o\">=</span><span class=\"n\">fields</span><span class=\"p\">)</span>\n</pre></div>\n\n\n<p>When I run this test on the tip of yt-dev, it picks up that there are 116 cells in the LightRay object, not just a single cell.  It doesn't fail because a handful of these cells have non-zero temperature values, whereas in your version of the code, it only finds the single cell with a zero temperature value.  I'm not sure why your version of the code would take the code snippet above for the FIRE dataset and only find a single cell--is it somehow disregarding the <code>'unitary'</code> unit system in lieu of using <code>'code_length'</code>?</p>",
                "markup": "markdown"
            },
            "created_on": "2016-08-24T17:02:05.771492+00:00",
            "updated_on": "2016-08-24T17:02:05.785516+00:00",
            "id": 22799237
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/brittonsmith"
                    },
                    "html": {
                        "href": "https://bitbucket.org/brittonsmith/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/brittonsmith/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "Britton Smith",
                "uuid": "{94333901-a436-4c2c-8322-8d09e387eece}",
                "username": "brittonsmith"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/22834853"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-22834853"
                }
            },
            "parent": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/22799237"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-22799237"
                    }
                },
                "id": 22799237
            },
            "pullrequest": {
                "title": "LightRay enhancements and bugfix (closes Issue #1258)",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345"
                    }
                },
                "id": 2345
            },
            "content": {
                "raw": "@chummels, this will be very helpful in tracking this down.  Thanks!",
                "html": "<p><a href=\"/chummels/\" rel=\"nofollow\" title=\"@chummels\" class=\"mention\">chummels</a>, this will be very helpful in tracking this down.  Thanks!</p>",
                "markup": "markdown"
            },
            "created_on": "2016-08-25T09:37:17.510156+00:00",
            "updated_on": "2016-08-25T09:37:17.522785+00:00",
            "id": 22834853
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/brittonsmith"
                    },
                    "html": {
                        "href": "https://bitbucket.org/brittonsmith/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/brittonsmith/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "Britton Smith",
                "uuid": "{94333901-a436-4c2c-8322-8d09e387eece}",
                "username": "brittonsmith"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/22838201"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-22838201"
                }
            },
            "parent": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/22799237"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-22799237"
                    }
                },
                "id": 22799237
            },
            "pullrequest": {
                "title": "LightRay enhancements and bugfix (closes Issue #1258)",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345"
                    }
                },
                "id": 2345
            },
            "content": {
                "raw": "@chummels, you were correct about the problem.  I identified a couple of places in the code where units were being stripped off or forced on arrays that already had different units.  In particular, there was an instance of an array with \"unitary\" units being remade as an array with \"code_length\".  I have reduced the number of places where the start and end position arrays are given units to a single instance at the very beginning of `make_light_ray`.  The code deals with units in a much safer way now.",
                "html": "<p><a href=\"/chummels/\" rel=\"nofollow\" title=\"@chummels\" class=\"mention\">chummels</a>, you were correct about the problem.  I identified a couple of places in the code where units were being stripped off or forced on arrays that already had different units.  In particular, there was an instance of an array with \"unitary\" units being remade as an array with \"code_length\".  I have reduced the number of places where the start and end position arrays are given units to a single instance at the very beginning of <code>make_light_ray</code>.  The code deals with units in a much safer way now.</p>",
                "markup": "markdown"
            },
            "created_on": "2016-08-25T10:33:27.647762+00:00",
            "updated_on": "2016-08-25T10:33:27.653730+00:00",
            "id": 22838201
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/yt-fido"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt-fido/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/yt-fido/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "yt-fido",
                "uuid": "{da2aa332-3f05-45c9-ae53-ff5ba34b35ce}",
                "username": "yt-fido"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/22843930"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-22843930"
                }
            },
            "pullrequest": {
                "title": "LightRay enhancements and bugfix (closes Issue #1258)",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345"
                    }
                },
                "id": 2345
            },
            "content": {
                "raw": "Docs were built for this PR. See https://tests.yt-project.org/job/yt_docs/1173/\nDocs build visible at https://tests.yt-project.org/job/yt_docs/1173/artifact/sandbox/doc/build/html/index.html",
                "html": "<p>Docs were built for this PR. See <a href=\"https://tests.yt-project.org/job/yt_docs/1173/\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_docs/1173/</a>\nDocs build visible at <a href=\"https://tests.yt-project.org/job/yt_docs/1173/artifact/sandbox/doc/build/html/index.html\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_docs/1173/artifact/sandbox/doc/build/html/index.html</a></p>",
                "markup": "markdown"
            },
            "created_on": "2016-08-25T12:27:12.896512+00:00",
            "updated_on": "2016-08-25T12:27:12.945642+00:00",
            "id": 22843930
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/brittonsmith"
                    },
                    "html": {
                        "href": "https://bitbucket.org/brittonsmith/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/brittonsmith/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "Britton Smith",
                "uuid": "{94333901-a436-4c2c-8322-8d09e387eece}",
                "username": "brittonsmith"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/22861009"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-22861009"
                }
            },
            "pullrequest": {
                "title": "LightRay enhancements and bugfix (closes Issue #1258)",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345"
                    }
                },
                "id": 2345
            },
            "content": {
                "raw": "As I make more of this code use unitful arrays properly, I continue to uncover other places that still do not.  This may a few more iterations to flush all the way through.",
                "html": "<p>As I make more of this code use unitful arrays properly, I continue to uncover other places that still do not.  This may a few more iterations to flush all the way through.</p>",
                "markup": "markdown"
            },
            "created_on": "2016-08-25T16:30:12.727464+00:00",
            "updated_on": "2016-08-25T16:30:12.733174+00:00",
            "id": 22861009
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/chummels"
                    },
                    "html": {
                        "href": "https://bitbucket.org/chummels/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/chummels/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "chummels",
                "uuid": "{de871bb8-32e9-450a-b8c9-2b49a1334f16}",
                "username": "chummels"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/22861090"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-22861090"
                }
            },
            "pullrequest": {
                "title": "LightRay enhancements and bugfix (closes Issue #1258)",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345"
                    }
                },
                "id": 2345
            },
            "content": {
                "raw": "Nice, it looks like your fixes got rid of a few of the errors.  But I'm still not sure why the main answer tests are failing.  It doesn't seem like you're doing things that would change the actual LightRay array, which could lead to changes in the AbsorptionSpectrum arrays.  Or at least, the changes that you're doing seem like they should be limited to either compound rays or simple rays, but there are test failures for both.  I have some ideas below.",
                "html": "<p>Nice, it looks like your fixes got rid of a few of the errors.  But I'm still not sure why the main answer tests are failing.  It doesn't seem like you're doing things that would change the actual LightRay array, which could lead to changes in the AbsorptionSpectrum arrays.  Or at least, the changes that you're doing seem like they should be limited to either compound rays or simple rays, but there are test failures for both.  I have some ideas below.</p>",
                "markup": "markdown"
            },
            "created_on": "2016-08-25T16:31:59.252035+00:00",
            "updated_on": "2016-08-25T16:31:59.256034+00:00",
            "id": 22861090
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/chummels"
                    },
                    "html": {
                        "href": "https://bitbucket.org/chummels/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/chummels/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "chummels",
                "uuid": "{de871bb8-32e9-450a-b8c9-2b49a1334f16}",
                "username": "chummels"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/22861123"
                },
                "code": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/diff/brittonsmith/yt:f3630a595d0f..c941aa457bc3?path=yt%2Fanalysis_modules%2Fcosmological_observation%2Flight_ray%2Flight_ray.py"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-22861123"
                }
            },
            "pullrequest": {
                "title": "LightRay enhancements and bugfix (closes Issue #1258)",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345"
                    }
                },
                "id": 2345
            },
            "content": {
                "raw": "Do you think this change in the random seed behavior could cause a different trajectory to be calculated?  By using the same seed, maybe this actually gets different behavior that would result in changes in the LightRay trajectory for compound rays.",
                "html": "<p>Do you think this change in the random seed behavior could cause a different trajectory to be calculated?  By using the same seed, maybe this actually gets different behavior that would result in changes in the LightRay trajectory for compound rays.</p>",
                "markup": "markdown"
            },
            "created_on": "2016-08-25T16:32:53.200848+00:00",
            "updated_on": "2016-08-25T16:32:53.207864+00:00",
            "inline": {
                "from": null,
                "path": "yt/analysis_modules/cosmological_observation/light_ray/light_ray.py",
                "to": 194
            },
            "id": 22861123
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/chummels"
                    },
                    "html": {
                        "href": "https://bitbucket.org/chummels/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/chummels/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "chummels",
                "uuid": "{de871bb8-32e9-450a-b8c9-2b49a1334f16}",
                "username": "chummels"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/22861264"
                },
                "code": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/diff/brittonsmith/yt:f3630a595d0f..c941aa457bc3?path=yt%2Fanalysis_modules%2Fcosmological_observation%2Fcosmology_splice.py"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-22861264"
                }
            },
            "pullrequest": {
                "title": "LightRay enhancements and bugfix (closes Issue #1258)",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345"
                    }
                },
                "id": 2345
            },
            "content": {
                "raw": "Do you think this change in behavior for the calculation of the redshift information would change the LightRay enough to cause the failures we're seeing with simple rays?  It's possible, particularly since your PR didn't have these failures when it was in its previous incarnation without the bugfix to address the cosmology calculations.",
                "html": "<p>Do you think this change in behavior for the calculation of the redshift information would change the LightRay enough to cause the failures we're seeing with simple rays?  It's possible, particularly since your PR didn't have these failures when it was in its previous incarnation without the bugfix to address the cosmology calculations.</p>",
                "markup": "markdown"
            },
            "created_on": "2016-08-25T16:36:20.826409+00:00",
            "updated_on": "2016-08-25T16:36:20.828801+00:00",
            "inline": {
                "from": null,
                "path": "yt/analysis_modules/cosmological_observation/cosmology_splice.py",
                "to": 320
            },
            "id": 22861264
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/yt-fido"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt-fido/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/yt-fido/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "yt-fido",
                "uuid": "{da2aa332-3f05-45c9-ae53-ff5ba34b35ce}",
                "username": "yt-fido"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/22865173"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-22865173"
                }
            },
            "pullrequest": {
                "title": "LightRay enhancements and bugfix (closes Issue #1258)",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345"
                    }
                },
                "id": 2345
            },
            "content": {
                "raw": "Docs were built for this PR. See https://tests.yt-project.org/job/yt_docs/1174/\nDocs build visible at https://tests.yt-project.org/job/yt_docs/1174/artifact/sandbox/doc/build/html/index.html",
                "html": "<p>Docs were built for this PR. See <a href=\"https://tests.yt-project.org/job/yt_docs/1174/\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_docs/1174/</a>\nDocs build visible at <a href=\"https://tests.yt-project.org/job/yt_docs/1174/artifact/sandbox/doc/build/html/index.html\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_docs/1174/artifact/sandbox/doc/build/html/index.html</a></p>",
                "markup": "markdown"
            },
            "created_on": "2016-08-25T17:54:17.495791+00:00",
            "updated_on": "2016-08-25T17:54:17.553340+00:00",
            "id": 22865173
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/yt-fido"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt-fido/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/yt-fido/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "yt-fido",
                "uuid": "{da2aa332-3f05-45c9-ae53-ff5ba34b35ce}",
                "username": "yt-fido"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/22907383"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-22907383"
                }
            },
            "pullrequest": {
                "title": "LightRay enhancements and bugfix (closes Issue #1258)",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345"
                    }
                },
                "id": 2345
            },
            "content": {
                "raw": "Docs were built for this PR. See https://tests.yt-project.org/job/yt_docs/1176/\nDocs build visible at https://tests.yt-project.org/job/yt_docs/1176/artifact/sandbox/doc/build/html/index.html",
                "html": "<p>Docs were built for this PR. See <a href=\"https://tests.yt-project.org/job/yt_docs/1176/\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_docs/1176/</a>\nDocs build visible at <a href=\"https://tests.yt-project.org/job/yt_docs/1176/artifact/sandbox/doc/build/html/index.html\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_docs/1176/artifact/sandbox/doc/build/html/index.html</a></p>",
                "markup": "markdown"
            },
            "created_on": "2016-08-26T12:56:05.357259+00:00",
            "updated_on": "2016-08-26T12:56:05.423542+00:00",
            "id": 22907383
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/yt-fido"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt-fido/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/yt-fido/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "yt-fido",
                "uuid": "{da2aa332-3f05-45c9-ae53-ff5ba34b35ce}",
                "username": "yt-fido"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/22936239"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-22936239"
                }
            },
            "pullrequest": {
                "title": "LightRay enhancements and bugfix (closes Issue #1258)",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345"
                    }
                },
                "id": 2345
            },
            "content": {
                "raw": "Docs were built for this PR. See https://tests.yt-project.org/job/yt_docs/1178/\nDocs build visible at https://tests.yt-project.org/job/yt_docs/1178/artifact/sandbox/doc/build/html/index.html",
                "html": "<p>Docs were built for this PR. See <a href=\"https://tests.yt-project.org/job/yt_docs/1178/\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_docs/1178/</a>\nDocs build visible at <a href=\"https://tests.yt-project.org/job/yt_docs/1178/artifact/sandbox/doc/build/html/index.html\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_docs/1178/artifact/sandbox/doc/build/html/index.html</a></p>",
                "markup": "markdown"
            },
            "created_on": "2016-08-27T09:42:45.487205+00:00",
            "updated_on": "2016-08-27T09:42:45.557570+00:00",
            "id": 22936239
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/yt-fido"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt-fido/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/yt-fido/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "yt-fido",
                "uuid": "{da2aa332-3f05-45c9-ae53-ff5ba34b35ce}",
                "username": "yt-fido"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/22938259"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-22938259"
                }
            },
            "pullrequest": {
                "title": "LightRay enhancements and bugfix (closes Issue #1258)",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345"
                    }
                },
                "id": 2345
            },
            "content": {
                "raw": "Docs were built for this PR. See https://tests.yt-project.org/job/yt_docs/1179/\nDocs build visible at https://tests.yt-project.org/job/yt_docs/1179/artifact/sandbox/doc/build/html/index.html",
                "html": "<p>Docs were built for this PR. See <a href=\"https://tests.yt-project.org/job/yt_docs/1179/\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_docs/1179/</a>\nDocs build visible at <a href=\"https://tests.yt-project.org/job/yt_docs/1179/artifact/sandbox/doc/build/html/index.html\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_docs/1179/artifact/sandbox/doc/build/html/index.html</a></p>",
                "markup": "markdown"
            },
            "created_on": "2016-08-27T19:23:16.389878+00:00",
            "updated_on": "2016-08-27T19:23:16.467338+00:00",
            "id": 22938259
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/brittonsmith"
                    },
                    "html": {
                        "href": "https://bitbucket.org/brittonsmith/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/brittonsmith/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "Britton Smith",
                "uuid": "{94333901-a436-4c2c-8322-8d09e387eece}",
                "username": "brittonsmith"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/22940061"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-22940061"
                }
            },
            "parent": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/22861090"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-22861090"
                    }
                },
                "id": 22861090
            },
            "pullrequest": {
                "title": "LightRay enhancements and bugfix (closes Issue #1258)",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345"
                    }
                },
                "id": 2345
            },
            "content": {
                "raw": "@chummels, thanks for your suggestions.  I have now tracked down all of the failures.  I have isolated three distinct changes that each contributed to the failing tests.\n\n1. The cosmological tests were failing because the start, end, left, and right coordinates were using the unit system of the cosmology calculator and not the unit system of the actual dataset.  The key different between those is the comoving/proper conversion, which does not work correctly for the cosmology calculator's unit system.  The problem occurred when the length of the ray was being calculated and converted into the proper frame.  [This](https://bitbucket.org/brittonsmith/yt/commits/c55375fd9efc7baa3d39586ada642e521608549c?at=yt) fixed that.\n\n2. There was a bug the `__init__` for the ray where it was taking in the start and end points and clobbering their units and replacing with `code_length`.  This was affecting the tests using Gadget data where `code_length` and `unitary` are different.  This only popped up once I added unit support to the rest of the light ray solution calculation.  I assumed that passing `YTArray` with `unitary` units would be fine, but these units were being overwritten.  [This](https://bitbucket.org/brittonsmith/yt/commits/df408d25ac13eabc3a105feccb79cfc65dca1ebb?at=yt) fixed that.\n\n3. The last six failing tests are all using simple rays with a single dataset.  They are failing because the current answers still have the problem described by [this issue](https://bitbucket.org/yt_analysis/yt/issues/1258/potential-unit-error-in-cosmologypy).  I have confirmed that undoing the bugfix will make the results agree for these last six.  Therefore, at this point, I think all that remains to be done is to update the test answer, but I will not do that until there is a response to this comment agreeing with that.\n\nFinally, just a quick note on the changeset that switched to using Hubble's Law for the initial guess in the `deltaz_forward` function.  This does also affect the answers for point #3 but only at the very last decimal place.  I did have to undo this as well to get perfect agreement.",
                "html": "<p><a href=\"/chummels/\" rel=\"nofollow\" title=\"@chummels\" class=\"mention\">chummels</a>, thanks for your suggestions.  I have now tracked down all of the failures.  I have isolated three distinct changes that each contributed to the failing tests.</p>\n<ol>\n<li>\n<p>The cosmological tests were failing because the start, end, left, and right coordinates were using the unit system of the cosmology calculator and not the unit system of the actual dataset.  The key different between those is the comoving/proper conversion, which does not work correctly for the cosmology calculator's unit system.  The problem occurred when the length of the ray was being calculated and converted into the proper frame.  <a href=\"https://bitbucket.org/brittonsmith/yt/commits/c55375fd9efc7baa3d39586ada642e521608549c?at=yt\">This</a> fixed that.</p>\n</li>\n<li>\n<p>There was a bug the <code>__init__</code> for the ray where it was taking in the start and end points and clobbering their units and replacing with <code>code_length</code>.  This was affecting the tests using Gadget data where <code>code_length</code> and <code>unitary</code> are different.  This only popped up once I added unit support to the rest of the light ray solution calculation.  I assumed that passing <code>YTArray</code> with <code>unitary</code> units would be fine, but these units were being overwritten.  <a href=\"https://bitbucket.org/brittonsmith/yt/commits/df408d25ac13eabc3a105feccb79cfc65dca1ebb?at=yt\">This</a> fixed that.</p>\n</li>\n<li>\n<p>The last six failing tests are all using simple rays with a single dataset.  They are failing because the current answers still have the problem described by <a href=\"https://bitbucket.org/yt_analysis/yt/issues/1258/potential-unit-error-in-cosmologypy\">this issue</a>.  I have confirmed that undoing the bugfix will make the results agree for these last six.  Therefore, at this point, I think all that remains to be done is to update the test answer, but I will not do that until there is a response to this comment agreeing with that.</p>\n</li>\n</ol>\n<p>Finally, just a quick note on the changeset that switched to using Hubble's Law for the initial guess in the <code>deltaz_forward</code> function.  This does also affect the answers for point <a href=\"/yt_analysis/yt/issues/3/fido-scripts-not-working\" rel=\"nofollow\" title=\"Fido scripts not working\"><s>#3</s></a> but only at the very last decimal place.  I did have to undo this as well to get perfect agreement.</p>",
                "markup": "markdown"
            },
            "created_on": "2016-08-28T09:00:14.794673+00:00",
            "updated_on": "2016-08-28T09:00:14.803607+00:00",
            "id": 22940061
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/ngoldbaum"
                    },
                    "html": {
                        "href": "https://bitbucket.org/ngoldbaum/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/ngoldbaum/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "Nathan Goldbaum",
                "uuid": "{5dcd72da-6420-4a6d-9571-e75dffcac587}",
                "username": "ngoldbaum"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/23231783"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-23231783"
                }
            },
            "pullrequest": {
                "title": "LightRay enhancements and bugfix (closes Issue #1258)",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345"
                    }
                },
                "id": 2345
            },
            "content": {
                "raw": "Looks like there are still test failures. Do the answers need to be updated?",
                "html": "<p>Looks like there are still test failures. Do the answers need to be updated?</p>",
                "markup": "markdown"
            },
            "created_on": "2016-09-02T14:43:45.521484+00:00",
            "updated_on": "2016-09-02T14:43:45.524674+00:00",
            "id": 23231783
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/brittonsmith"
                    },
                    "html": {
                        "href": "https://bitbucket.org/brittonsmith/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/brittonsmith/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "Britton Smith",
                "uuid": "{94333901-a436-4c2c-8322-8d09e387eece}",
                "username": "brittonsmith"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/23237384"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-23237384"
                }
            },
            "parent": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/23231783"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-23231783"
                    }
                },
                "id": 23231783
            },
            "pullrequest": {
                "title": "LightRay enhancements and bugfix (closes Issue #1258)",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345"
                    }
                },
                "id": 2345
            },
            "content": {
                "raw": "See my comment above.  The last remaining test failures should just be because the answers need to be updated.  I'm ready to bump the version number for the test answers, but just wanted to make sure people were in agreement with this.",
                "html": "<p>See my comment above.  The last remaining test failures should just be because the answers need to be updated.  I'm ready to bump the version number for the test answers, but just wanted to make sure people were in agreement with this.</p>",
                "markup": "markdown"
            },
            "created_on": "2016-09-02T16:16:41.421746+00:00",
            "updated_on": "2016-09-02T16:16:41.427269+00:00",
            "id": 23237384
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/ngoldbaum"
                    },
                    "html": {
                        "href": "https://bitbucket.org/ngoldbaum/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/ngoldbaum/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "Nathan Goldbaum",
                "uuid": "{5dcd72da-6420-4a6d-9571-e75dffcac587}",
                "username": "ngoldbaum"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/23237664"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-23237664"
                }
            },
            "parent": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/23237384"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-23237384"
                    }
                },
                "id": 23237384
            },
            "pullrequest": {
                "title": "LightRay enhancements and bugfix (closes Issue #1258)",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345"
                    }
                },
                "id": 2345
            },
            "content": {
                "raw": "@chummels mind weighing in?",
                "html": "<p><a href=\"/chummels/\" rel=\"nofollow\" title=\"@chummels\" class=\"mention\">chummels</a> mind weighing in?</p>",
                "markup": "markdown"
            },
            "created_on": "2016-09-02T16:23:15.382812+00:00",
            "updated_on": "2016-09-02T16:23:15.389678+00:00",
            "id": 23237664
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/chummels"
                    },
                    "html": {
                        "href": "https://bitbucket.org/chummels/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/chummels/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "chummels",
                "uuid": "{de871bb8-32e9-450a-b8c9-2b49a1334f16}",
                "username": "chummels"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/23251852"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-23251852"
                }
            },
            "parent": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/23237664"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-23237664"
                    }
                },
                "id": 23237664
            },
            "pullrequest": {
                "title": "LightRay enhancements and bugfix (closes Issue #1258)",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345"
                    }
                },
                "id": 2345
            },
            "content": {
                "raw": "Great detective work, @brittonsmith .  Sorry for my delayed response--internet has been problematic this week that I'm away.  I am definitely in favor of bumping the version and merging.  This is all great work, with additional tests, and docs, it's just been a bear tracking down the failures.  I think it's taken care of now as per @brittonsmith 's comment from above.",
                "html": "<p>Great detective work, <a href=\"/brittonsmith/\" rel=\"nofollow\" title=\"@brittonsmith\" class=\"mention\">Britton Smith</a> .  Sorry for my delayed response--internet has been problematic this week that I'm away.  I am definitely in favor of bumping the version and merging.  This is all great work, with additional tests, and docs, it's just been a bear tracking down the failures.  I think it's taken care of now as per <a href=\"/brittonsmith/\" rel=\"nofollow\" title=\"@brittonsmith\" class=\"mention\">Britton Smith</a> 's comment from above.</p>",
                "markup": "markdown"
            },
            "created_on": "2016-09-03T02:38:09.540205+00:00",
            "updated_on": "2016-09-03T02:38:09.550497+00:00",
            "id": 23251852
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/brittonsmith"
                    },
                    "html": {
                        "href": "https://bitbucket.org/brittonsmith/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/brittonsmith/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "Britton Smith",
                "uuid": "{94333901-a436-4c2c-8322-8d09e387eece}",
                "username": "brittonsmith"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/23252576"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-23252576"
                }
            },
            "parent": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/23251852"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-23251852"
                    }
                },
                "id": 23251852
            },
            "pullrequest": {
                "title": "LightRay enhancements and bugfix (closes Issue #1258)",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345"
                    }
                },
                "id": 2345
            },
            "content": {
                "raw": "Great! Thanks, @chummels, I will bump the answer test number now.",
                "html": "<p>Great! Thanks, <a href=\"/chummels/\" rel=\"nofollow\" title=\"@chummels\" class=\"mention\">chummels</a>, I will bump the answer test number now.</p>",
                "markup": "markdown"
            },
            "created_on": "2016-09-03T06:54:37.351754+00:00",
            "updated_on": "2016-09-03T06:54:37.364506+00:00",
            "id": 23252576
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/yt-fido"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt-fido/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/yt-fido/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "yt-fido",
                "uuid": "{da2aa332-3f05-45c9-ae53-ff5ba34b35ce}",
                "username": "yt-fido"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345/comments/23252881"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345/_/diff#comment-23252881"
                }
            },
            "pullrequest": {
                "title": "LightRay enhancements and bugfix (closes Issue #1258)",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2345"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2345"
                    }
                },
                "id": 2345
            },
            "content": {
                "raw": "* Docs were built for this PR. See https://tests.yt-project.org/job/yt_docs/1192/\nDocs build visible at https://tests.yt-project.org/job/yt_docs/1192/artifact/sandbox/doc/build/html/index.html\n* Docs were built for this PR. See https://tests.yt-project.org/job/yt_docs/1193/. Docs build visible at https://tests.yt-project.org/job/yt_docs/1193/artifact/sandbox/doc/build/html/index.html\n",
                "html": "<ul>\n<li>Docs were built for this PR. See <a href=\"https://tests.yt-project.org/job/yt_docs/1192/\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_docs/1192/</a>\nDocs build visible at <a href=\"https://tests.yt-project.org/job/yt_docs/1192/artifact/sandbox/doc/build/html/index.html\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_docs/1192/artifact/sandbox/doc/build/html/index.html</a></li>\n<li>Docs were built for this PR. See <a href=\"https://tests.yt-project.org/job/yt_docs/1193/\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_docs/1193/</a>. Docs build visible at <a href=\"https://tests.yt-project.org/job/yt_docs/1193/artifact/sandbox/doc/build/html/index.html\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_docs/1193/artifact/sandbox/doc/build/html/index.html</a></li>\n</ul>",
                "markup": "markdown"
            },
            "created_on": "2016-09-03T08:20:44.921291+00:00",
            "updated_on": "2016-09-04T18:03:13.421384+00:00",
            "id": 23252881
        }
    ]
}