{
    "reason": "",
    "state": "MERGED",
    "updated_on": "2016-03-09T17:32:46.467544+00:00",
    "comment_count": 8,
    "description": "This adds a new method for computing ghost zone bounding boxes.\r\n\r\nIn some cases, particularly where IO is the limiting factor, this can result in\r\nmuch greater speedups.  However, for cases where IO is not a limiting factor,\r\nit can slow things down -- the number of calls to `fill_mask` is increased.\r\n\r\nFor cases like those reported on the mailing list (where a networked filesystem\r\nand lots of small reads/opens, particularly with a deep hierarchy) are\r\nencountered, this may still have a net benefit.  I am investigating if further\r\nimprovements can be made for other situations.\r\n\r\nFor me, Enzo answer tests passed.  I've left WIP off this so that the tests\r\nwill continue to run.\r\n\r\nUPDATE 1: With the additional index computations I've stuck into the region selector, this should now also be faster in cases where IO is *not* the limiting factor, as we can short-circuit lots of calls to `select_cell` in the mask computation.  I am happy with this PR as-is, and I'm getting big speedups here on everything I've thrown at it.\r\n\r\n",
    "created_on": "2016-03-05T23:15:20.083204+00:00",
    "task_count": 0,
    "merge_commit": {
        "links": {
            "self": {
                "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/commit/14b7d1b6b906"
            }
        },
        "hash": "14b7d1b6b906"
    },
    "title": "Ghost zone optimization and experimentation",
    "links": {
        "diff": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2025/diff"
        },
        "decline": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2025/decline"
        },
        "self": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2025"
        },
        "activity": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2025/activity"
        },
        "merge": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2025/merge"
        },
        "commits": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2025/commits"
        },
        "statuses": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2025/statuses"
        },
        "approve": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2025/approve"
        },
        "html": {
            "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2025"
        },
        "comments": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2025/comments"
        }
    },
    "closed_by": {
        "links": {
            "self": {
                "href": "https://api.bitbucket.org/2.0/users/atmyers"
            },
            "html": {
                "href": "https://bitbucket.org/atmyers/"
            },
            "avatar": {
                "href": "https://bitbucket.org/account/atmyers/avatar/32/"
            }
        },
        "type": "user",
        "display_name": "Andrew Myers",
        "uuid": "{651c5647-b78f-4cd9-8d9a-5d6e8c9ac8d3}",
        "username": "atmyers"
    },
    "id": 2025,
    "type": "pullrequest",
    "author": {
        "links": {
            "self": {
                "href": "https://api.bitbucket.org/2.0/users/MatthewTurk"
            },
            "html": {
                "href": "https://bitbucket.org/MatthewTurk/"
            },
            "avatar": {
                "href": "https://bitbucket.org/account/MatthewTurk/avatar/32/"
            }
        },
        "type": "user",
        "display_name": "Matt Turk",
        "uuid": "{b3f0b280-55fc-4e8a-8bd1-40478d4cbdbf}",
        "username": "MatthewTurk"
    },
    "source": {
        "branch": {
            "name": "yt"
        },
        "commit": {
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/MatthewTurk/yt/commit/a74c12c0cbbc"
                }
            },
            "hash": "a74c12c0cbbc"
        },
        "repository": {
            "full_name": "MatthewTurk/yt",
            "type": "repository",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/MatthewTurk/yt"
                },
                "html": {
                    "href": "https://bitbucket.org/MatthewTurk/yt"
                },
                "avatar": {
                    "href": "https://bitbucket.org/MatthewTurk/yt/avatar/32/"
                }
            },
            "name": "yt",
            "uuid": "{b5dfa70b-707c-4330-92a8-e3ea1bee18b3}"
        }
    },
    "close_source_branch": false,
    "destination": {
        "branch": {
            "name": "yt"
        },
        "commit": {
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/commit/7bc62a2db2de"
                }
            },
            "hash": "7bc62a2db2de"
        },
        "repository": {
            "full_name": "yt_analysis/yt",
            "type": "repository",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt"
                },
                "avatar": {
                    "href": "https://bitbucket.org/yt_analysis/yt/avatar/32/"
                }
            },
            "name": "yt",
            "uuid": "{b73cb37c-40f2-493a-aaa9-41bc8d8974cc}"
        }
    },
    "comments": [
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/yt-fido"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt-fido/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/yt-fido/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "yt-fido",
                "uuid": "{da2aa332-3f05-45c9-ae53-ff5ba34b35ce}",
                "username": "yt-fido"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2025/comments/15372528"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2025/_/diff#comment-15372528"
                }
            },
            "pullrequest": {
                "title": "Ghost zone optimization and experimentation",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2025"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2025"
                    }
                },
                "id": 2025
            },
            "content": {
                "raw": "All tests pass. Good job! https://tests.yt-project.org/job/yt_testsuite_dev/1366/",
                "html": "<p>All tests pass. Good job! <a href=\"https://tests.yt-project.org/job/yt_testsuite_dev/1366/\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_testsuite_dev/1366/</a></p>",
                "markup": "markdown"
            },
            "created_on": "2016-03-06T00:13:21.400852+00:00",
            "updated_on": "2016-03-06T00:13:21.800556+00:00",
            "id": 15372528
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/yt-fido"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt-fido/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/yt-fido/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "yt-fido",
                "uuid": "{da2aa332-3f05-45c9-ae53-ff5ba34b35ce}",
                "username": "yt-fido"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2025/comments/15373323"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2025/_/diff#comment-15373323"
                }
            },
            "pullrequest": {
                "title": "Ghost zone optimization and experimentation",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2025"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2025"
                    }
                },
                "id": 2025
            },
            "content": {
                "raw": "All tests pass. Good job! https://tests.yt-project.org/job/yt_testsuite_dev/1367/",
                "html": "<p>All tests pass. Good job! <a href=\"https://tests.yt-project.org/job/yt_testsuite_dev/1367/\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_testsuite_dev/1367/</a></p>",
                "markup": "markdown"
            },
            "created_on": "2016-03-06T01:25:44.772450+00:00",
            "updated_on": "2016-03-06T01:25:44.847917+00:00",
            "id": 15373323
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/MatthewTurk"
                    },
                    "html": {
                        "href": "https://bitbucket.org/MatthewTurk/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/MatthewTurk/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "Matthew Turk",
                "uuid": "{b3f0b280-55fc-4e8a-8bd1-40478d4cbdbf}",
                "username": "MatthewTurk"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2025/comments/15374995"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2025/_/diff#comment-15374995"
                }
            },
            "pullrequest": {
                "title": "Ghost zone optimization and experimentation",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2025"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2025"
                    }
                },
                "id": 2025
            },
            "content": {
                "raw": "I've found a few more bits that could help out.  Some may require other pending PRs.  For instance, if I remove the calls to `ensure_code` in the `RegionSelector`, runtime goes down by about 10%.  These shouldn't be necessary following PR 1891.  A fair portion of the remaining time is spent in the chunking code, which can be fixed by better use of grid visitors.  I'm considerably happier with the runtime as it is right now, as it's already showing itself to be IO limited, but limited by a much smaller number of files/reads.",
                "html": "<p>I've found a few more bits that could help out.  Some may require other pending PRs.  For instance, if I remove the calls to <code>ensure_code</code> in the <code>RegionSelector</code>, runtime goes down by about 10%.  These shouldn't be necessary following PR 1891.  A fair portion of the remaining time is spent in the chunking code, which can be fixed by better use of grid visitors.  I'm considerably happier with the runtime as it is right now, as it's already showing itself to be IO limited, but limited by a much smaller number of files/reads.</p>",
                "markup": "markdown"
            },
            "created_on": "2016-03-06T05:45:18.470964+00:00",
            "updated_on": "2016-03-06T05:45:18.476535+00:00",
            "id": 15374995
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/yt-fido"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt-fido/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/yt-fido/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "yt-fido",
                "uuid": "{da2aa332-3f05-45c9-ae53-ff5ba34b35ce}",
                "username": "yt-fido"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2025/comments/15375425"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2025/_/diff#comment-15375425"
                }
            },
            "pullrequest": {
                "title": "Ghost zone optimization and experimentation",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2025"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2025"
                    }
                },
                "id": 2025
            },
            "content": {
                "raw": "Something went wrong, you should checkout https://tests.yt-project.org/job/yt_testsuite_dev/1370/",
                "html": "<p>Something went wrong, you should checkout <a href=\"https://tests.yt-project.org/job/yt_testsuite_dev/1370/\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_testsuite_dev/1370/</a></p>",
                "markup": "markdown"
            },
            "created_on": "2016-03-06T06:33:12.967043+00:00",
            "updated_on": "2016-03-06T06:33:13.058218+00:00",
            "id": 15375425
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/ngoldbaum"
                    },
                    "html": {
                        "href": "https://bitbucket.org/ngoldbaum/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/ngoldbaum/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "Nathan Goldbaum",
                "uuid": "{5dcd72da-6420-4a6d-9571-e75dffcac587}",
                "username": "ngoldbaum"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2025/comments/15380603"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2025/_/diff#comment-15380603"
                }
            },
            "pullrequest": {
                "title": "Ghost zone optimization and experimentation",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2025"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2025"
                    }
                },
                "id": 2025
            },
            "content": {
                "raw": "I tested this and am also seeing very substantial speedups for operations that need ghost zones.\n\nAwesome work @MatthewTurk!",
                "html": "<p>I tested this and am also seeing very substantial speedups for operations that need ghost zones.</p>\n<p>Awesome work <a href=\"/MatthewTurk/\" rel=\"nofollow\" title=\"@MatthewTurk\" class=\"mention\">Matthew Turk</a>!</p>",
                "markup": "markdown"
            },
            "created_on": "2016-03-06T16:21:58.830846+00:00",
            "updated_on": "2016-03-06T16:21:58.835642+00:00",
            "id": 15380603
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/yt-fido"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt-fido/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/yt-fido/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "yt-fido",
                "uuid": "{da2aa332-3f05-45c9-ae53-ff5ba34b35ce}",
                "username": "yt-fido"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2025/comments/15380788"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2025/_/diff#comment-15380788"
                }
            },
            "pullrequest": {
                "title": "Ghost zone optimization and experimentation",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2025"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2025"
                    }
                },
                "id": 2025
            },
            "content": {
                "raw": "All tests pass. Good job! https://tests.yt-project.org/job/yt_testsuite_dev/1371/",
                "html": "<p>All tests pass. Good job! <a href=\"https://tests.yt-project.org/job/yt_testsuite_dev/1371/\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_testsuite_dev/1371/</a></p>",
                "markup": "markdown"
            },
            "created_on": "2016-03-06T17:06:55.384611+00:00",
            "updated_on": "2016-03-06T17:06:55.449694+00:00",
            "id": 15380788
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/MatthewTurk"
                    },
                    "html": {
                        "href": "https://bitbucket.org/MatthewTurk/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/MatthewTurk/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "Matthew Turk",
                "uuid": "{b3f0b280-55fc-4e8a-8bd1-40478d4cbdbf}",
                "username": "MatthewTurk"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2025/comments/15382690"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2025/_/diff#comment-15382690"
                }
            },
            "parent": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2025/comments/15380603"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2025/_/diff#comment-15380603"
                    }
                },
                "id": 15380603
            },
            "pullrequest": {
                "title": "Ghost zone optimization and experimentation",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2025"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2025"
                    }
                },
                "id": 2025
            },
            "content": {
                "raw": "Thanks, @ngoldbaum !\n\nI've now tested on a dataset that's relatively large (it's via @brittonsmith ) with 121k grids that are all over the place, with max level 27, and the new version seems to be considerably faster when IO is removed from the equation.  Since this should also overall reduce IO, I think that it should all-in-all be considerably faster overall for datasets like that.",
                "html": "<p>Thanks, <a href=\"/ngoldbaum/\" rel=\"nofollow\" title=\"@ngoldbaum\" class=\"mention\">Nathan Goldbaum</a> !</p>\n<p>I've now tested on a dataset that's relatively large (it's via <a href=\"/brittonsmith/\" rel=\"nofollow\" title=\"@brittonsmith\" class=\"mention\">Britton Smith</a> ) with 121k grids that are all over the place, with max level 27, and the new version seems to be considerably faster when IO is removed from the equation.  Since this should also overall reduce IO, I think that it should all-in-all be considerably faster overall for datasets like that.</p>",
                "markup": "markdown"
            },
            "created_on": "2016-03-06T20:10:40.441790+00:00",
            "updated_on": "2016-03-06T20:10:40.872547+00:00",
            "id": 15382690
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/yt-fido"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt-fido/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/yt-fido/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "yt-fido",
                "uuid": "{da2aa332-3f05-45c9-ae53-ff5ba34b35ce}",
                "username": "yt-fido"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2025/comments/15383716"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2025/_/diff#comment-15383716"
                }
            },
            "pullrequest": {
                "title": "Ghost zone optimization and experimentation",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/2025"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/2025"
                    }
                },
                "id": 2025
            },
            "content": {
                "raw": "All tests pass. Good job! https://tests.yt-project.org/job/yt_testsuite_dev/1372/",
                "html": "<p>All tests pass. Good job! <a href=\"https://tests.yt-project.org/job/yt_testsuite_dev/1372/\" rel=\"nofollow\">https://tests.yt-project.org/job/yt_testsuite_dev/1372/</a></p>",
                "markup": "markdown"
            },
            "created_on": "2016-03-06T21:16:14.118830+00:00",
            "updated_on": "2016-03-06T21:16:14.339985+00:00",
            "id": 15383716
        }
    ]
}