{
    "reason": "",
    "state": "MERGED",
    "updated_on": "2015-09-25T07:21:05.946113+00:00",
    "comment_count": 4,
    "description": "This adds a `redshift_eff` field to the LightRay object. The existing field `redshift` refers to purely cosmological redshift, and `redshift_eff` incorporates doppler redshift to give an effective redshift with both terms.  This PR also then uses this new field in the Absorption Spectrum analysis module.\r\n\r\n* Adding effective redshift field to LightRay output fields.  Incorporates velocity into cosmological redshift.\r\n\r\n* Make absorption_spectrum utilize the effective redshift field in its calculation of observed wavelength of lines and continua.  Better approximation of doppler redshift than just z ~ v/c.\r\n\r\nUPDATE1: @brittonsmith and I spent a bunch of time checking how cosmological and doppler redshifts should be combined and whether the velocities should be in the proper frame or the comoving frame.  After doing some derivations out of Peebles, Peacock, and then checking with others who've addressed this problem in the past (Romeel and @benopp ), we've concluded that this is the appropriate form.  Notably, there was a mistake in the previous way in which doppler and cosmological redshifts were added, although it would only have an effect in the high-z world.  This corrects this mistake and moves the machinery to the LightRay analysis module.",
    "created_on": "2015-09-18T01:59:55.320005+00:00",
    "task_count": 0,
    "merge_commit": null,
    "title": "[BUGFIX] Adding effective redshift field to Light Ray analysis module for use in AbsorptionSpectrum",
    "links": {
        "diff": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/1758/diff"
        },
        "decline": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/1758/decline"
        },
        "self": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/1758"
        },
        "activity": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/1758/activity"
        },
        "merge": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/1758/merge"
        },
        "commits": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/1758/commits"
        },
        "statuses": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/1758/statuses"
        },
        "approve": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/1758/approve"
        },
        "html": {
            "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/1758"
        },
        "comments": {
            "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/1758/comments"
        }
    },
    "closed_by": {
        "links": {
            "self": {
                "href": "https://api.bitbucket.org/2.0/users/brittonsmith"
            },
            "html": {
                "href": "https://bitbucket.org/brittonsmith/"
            },
            "avatar": {
                "href": "https://bitbucket.org/account/brittonsmith/avatar/32/"
            }
        },
        "type": "user",
        "display_name": "Britton Smith",
        "uuid": "{94333901-a436-4c2c-8322-8d09e387eece}",
        "username": "brittonsmith"
    },
    "id": 1758,
    "type": "pullrequest",
    "author": {
        "links": {
            "self": {
                "href": "https://api.bitbucket.org/2.0/users/chummels"
            },
            "html": {
                "href": "https://bitbucket.org/chummels/"
            },
            "avatar": {
                "href": "https://bitbucket.org/account/chummels/avatar/32/"
            }
        },
        "type": "user",
        "display_name": "chummels",
        "uuid": "{de871bb8-32e9-450a-b8c9-2b49a1334f16}",
        "username": "chummels"
    },
    "source": {
        "branch": {
            "name": "yt"
        },
        "commit": {
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/chummels/yt/commit/b7afd79a9820"
                }
            },
            "hash": "b7afd79a9820"
        },
        "repository": {
            "full_name": "chummels/yt",
            "type": "repository",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/chummels/yt"
                },
                "html": {
                    "href": "https://bitbucket.org/chummels/yt"
                },
                "avatar": {
                    "href": "https://bitbucket.org/chummels/yt/avatar/32/"
                }
            },
            "name": "yt",
            "uuid": "{cc72b7fe-3d37-4cd2-a367-f2de113a2e82}"
        }
    },
    "close_source_branch": false,
    "destination": {
        "branch": {
            "name": "yt"
        },
        "commit": {
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/commit/d70d717bcd11"
                }
            },
            "hash": "d70d717bcd11"
        },
        "repository": {
            "full_name": "yt_analysis/yt",
            "type": "repository",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt"
                },
                "avatar": {
                    "href": "https://bitbucket.org/yt_analysis/yt/avatar/32/"
                }
            },
            "name": "yt",
            "uuid": "{b73cb37c-40f2-493a-aaa9-41bc8d8974cc}"
        }
    },
    "comments": [
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/chummels"
                    },
                    "html": {
                        "href": "https://bitbucket.org/chummels/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/chummels/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "Cameron Hummels",
                "uuid": "{de871bb8-32e9-450a-b8c9-2b49a1334f16}",
                "username": "chummels"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/1758/comments/10026606"
                },
                "code": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/diff/chummels/yt:7ab67784cfd4..d70d717bcd11?path=yt%2Fanalysis_modules%2Fcosmological_observation%2Flight_ray%2Flight_ray.py"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/1758/_/diff#comment-10026606"
                }
            },
            "pullrequest": {
                "title": "[BUGFIX] Adding effective redshift field to Light Ray analysis module for use in AbsorptionSpectrum",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/1758"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/1758"
                    }
                },
                "id": 1758
            },
            "content": {
                "raw": "Can someone verify that we *do* in fact want the doppler redshift calculated by converting our line of sight velocity into the comoving frame instead of leaving it in the proper frame?  I've preserved this from a previous iteration of the code, but I'm a little dubious that this is what we want to do.  It seems like velocity in proper units is the way to go here, so we can get rid of the extra (1+z) term.",
                "html": "<p>Can someone verify that we <em>do</em> in fact want the doppler redshift calculated by converting our line of sight velocity into the comoving frame instead of leaving it in the proper frame?  I've preserved this from a previous iteration of the code, but I'm a little dubious that this is what we want to do.  It seems like velocity in proper units is the way to go here, so we can get rid of the extra (1+z) term.</p>",
                "markup": "markdown"
            },
            "created_on": "2015-09-18T02:00:26.799375+00:00",
            "updated_on": "2015-09-18T02:00:26.808667+00:00",
            "inline": {
                "from": null,
                "path": "yt/analysis_modules/cosmological_observation/light_ray/light_ray.py",
                "to": 467
            },
            "id": 10026606
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/yt-fido"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt-fido/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/yt-fido/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "yt-fido",
                "uuid": "{da2aa332-3f05-45c9-ae53-ff5ba34b35ce}",
                "username": "yt-fido"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/1758/comments/10027712"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/1758/_/diff#comment-10027712"
                }
            },
            "pullrequest": {
                "title": "[BUGFIX] Adding effective redshift field to Light Ray analysis module for use in AbsorptionSpectrum",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/1758"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/1758"
                    }
                },
                "id": 1758
            },
            "content": {
                "raw": "All tests pass. Good job!",
                "html": "<p>All tests pass. Good job!</p>",
                "markup": "markdown"
            },
            "created_on": "2015-09-18T03:37:13.084092+00:00",
            "updated_on": "2015-09-18T03:37:13.151382+00:00",
            "id": 10027712
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/yt-fido"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt-fido/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/yt-fido/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "yt-fido",
                "uuid": "{da2aa332-3f05-45c9-ae53-ff5ba34b35ce}",
                "username": "yt-fido"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/1758/comments/10185655"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/1758/_/diff#comment-10185655"
                }
            },
            "pullrequest": {
                "title": "[BUGFIX] Adding effective redshift field to Light Ray analysis module for use in AbsorptionSpectrum",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/1758"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/1758"
                    }
                },
                "id": 1758
            },
            "content": {
                "raw": "All tests pass. Good job!",
                "html": "<p>All tests pass. Good job!</p>",
                "markup": "markdown"
            },
            "created_on": "2015-09-23T22:50:22.100805+00:00",
            "updated_on": "2015-09-23T22:50:22.164397+00:00",
            "id": 10185655
        },
        {
            "user": {
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/users/brittonsmith"
                    },
                    "html": {
                        "href": "https://bitbucket.org/brittonsmith/"
                    },
                    "avatar": {
                        "href": "https://bitbucket.org/account/brittonsmith/avatar/32/"
                    }
                },
                "type": "user",
                "display_name": "Britton Smith",
                "uuid": "{94333901-a436-4c2c-8322-8d09e387eece}",
                "username": "brittonsmith"
            },
            "type": "pullrequest_comment",
            "links": {
                "self": {
                    "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/1758/comments/10223298"
                },
                "html": {
                    "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/1758/_/diff#comment-10223298"
                }
            },
            "pullrequest": {
                "title": "[BUGFIX] Adding effective redshift field to Light Ray analysis module for use in AbsorptionSpectrum",
                "type": "pullrequest",
                "links": {
                    "self": {
                        "href": "https://api.bitbucket.org/2.0/repositories/yt_analysis/yt/pullrequests/1758"
                    },
                    "html": {
                        "href": "https://bitbucket.org/yt_analysis/yt/pull-requests/1758"
                    }
                },
                "id": 1758
            },
            "content": {
                "raw": "Thanks for fixing this up, @chummels.  I'm glad this is now right.  I'll accept this tomorrow morning if there are no additional comments by then.",
                "html": "<p>Thanks for fixing this up, <a href=\"/chummels/\" rel=\"nofollow\" title=\"@chummels\" class=\"mention\">Cameron Hummels</a>.  I'm glad this is now right.  I'll accept this tomorrow morning if there are no additional comments by then.</p>",
                "markup": "markdown"
            },
            "created_on": "2015-09-24T21:05:01.675710+00:00",
            "updated_on": "2015-09-24T21:05:01.686836+00:00",
            "id": 10223298
        }
    ]
}